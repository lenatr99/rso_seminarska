 Amoeboid cell motility is essential for a wide range of biological processes including wound healing, embryonic morphogenesis, and cancer metastasis. It relies on complex dynamical patterns of cell shape changes that pose long-standing challenges to mathematical modeling and raise a need for automated and reproducible approaches to extract quantitative morphological features from image sequences. Here, we introduce a theoretical framework and a computational method for obtaining smooth representations of the spatiotemporal contour dynamics from stacks of segmented microscopy images. Based on a Gaussian process regression we propose a one-parameter family of regularized contour flows that allows us to continuously track reference points between successive cell contours. We use this approach to define a coordinate system on the moving cell boundary and to represent different local geometric quantities in this frame of reference. In particular, we introduce the local marker dispersion as a measure to identify localized membrane expansions and provide a fully automated way to extract the properties of such expansions, including their area and growth time. The methods are available as an open-source software package called AmoePy, a Python-based toolbox for analyzing amoeboid cell motility, including a graphical user interface and detailed documentation. Due to the mathematical rigor of our framework, we envision it to be of use for the development of novel cell motility models. We mainly use experimental data of the social amoeba Dictyostelium discoideum to illustrate and validate our approach. Author summary Amoeboid motion is a crawling-like cell migration that plays an important key role in multiple biological processes such as wound healing and cancer metastasis. This type of cell motility results from expanding and simultaneously contracting parts of the cell membrane. From fluorescence images, we obtain a sequence of points, representing the cell membrane, for each time step. By using regression analysis on these sequences, we derive smooth representations, so-called contours, of the membrane. Since the number of measurements is discrete and often limited, the question is raised of how to link consecutive contours with each other. In this work, we present a novel mathematical framework in which these links are described by regularized flows allowing a certain degree of concentration or stretching of neighboring reference points on the same contour. This stretching rate, the so-called local dispersion, is used to identify expansions and contractions of the cell membrane providing a fully automated way of extracting properties of these cell shape changes. We applied our methods to time-lapse microscopy data of the social amoeba Dictyostelium discoideum. This is a PLOS Computational Biology Methods paper. Introduction Amoeboid motion is one of the most widespread forms of cell motility in the living world. It plays a key role in many essential functions of the human body, such as responses of the immune system or the healing of injured tissue. Its medical relevance also extends to the field of cancer research, as metastatic tumor cells rely on amoeboid motility to invade the surrounding tissue. Amoeboid locomotion is based on dynamical changes of the cell shape. Specifically, localized protrusions of the cell membrane, often called pseudopodia, that are extended in the direction of motion, are generally seen as the basic morphological entities that drive amoeboid movement. Together with membrane contraction at the back of the cell body, their extension results in a displacement of the center of mass of the cell. This requires, besides the coordinated pattern of protrusion and retraction, also the formation and rupture of adhesive contacts to a substrate or to a surrounding extracellular matrix. The mechanical forces that drive the shape changes of amoeboid cells are generated by the actin cytoskeleton, a dynamic filament meshwork at the inner face of the cell membrane. The main building blocks of this network are actin filaments that are subject to a constant turnover by polymerization and depolymerization, resulting in a continuous rapid reorganization of the network structure. This process is assisted by a host of auxiliary cytoskeletal proteins that initiate the nucleation, capping, or severing of actin filaments as well as filament bundling, branching, and membrane cross-linking. The cytoskeletal machinery is orchestrated by biochemical signaling pathways that coordinate the spatiotemporal patterns of activity in the actin system across the cell cortex. These upstream signaling pathways also provide a link to membrane receptor signals, so that cells may react to gradients of extracellular cues by moving directionally towards a chemical source—a process commonly referred to as chemotaxis. The mathematical modeling of amoeboid motion is a long-standing challenge that has been addressed at different levels of complexity, ranging from random walk models for the center of mass of the cell up to detailed high-dimensional models for the intracellular signaling activity. Typically, current models focus on selected mechanistic aspects of amoeboid motility and describe, for example, actin dynamics, cell-to-cell variability, or the switching between different migratory modes in more detail, see for example. Also, first attempts have been made to incorporate several key components, such as dynamic signaling patterns, polarity formation, and cytoskeletal activity, in a modular approach. These models, however, remain qualitative and their comparison with experimental data oftentimes relies on visual inspection. As the entire biological process involves many hundreds of interacting proteins and signaling molecules, with many mechanistic details yet unknown, a quantitative model that includes the full molecular details remains out of reach. To advance the mathematical description of amoeboid motility, we envision that current efforts of mechanism-based modeling are complemented by a more systematic, data-driven approach. This requires a mathematical framework that allows us to systematically develop a quantitative model based on experimental data. Such a framework should rely on observables that encode the key characteristics of amoeboid motility and, at the same time, are readily accessible experimentally. Trajectories of the center-of-mass of the cell can be easily recorded in large amounts from low-resolution bright-field microscopy data but reflect only very limited, integral information on the entire process. The intracellular signaling pathways and the cytoskeletal mechanisms, on the other hand, are difficult to access and knowledge on this part of the system remains highly incomplete. We therefore concentrate on the cell shape as the central reference quantity. The cell shape is fully accessible by standard microscopy techniques and can be easily recorded with sufficient spatial and temporal resolution. Moreover, its dynamic evolution implicitly reflects the intracellular processes and determines the center-of-mass trajectory of the cell. In our long-term quest for a quantitative, data-driven model of amoeboid motility, several steps are required: First, the development of a mathematical framework for the description of experimentally observed shape dynamics; second, the design of a model of the contour dynamics that predicts realistic shape evolutions; and finally, the incorporation of mechanistic information on key intracellular processes as the driving determinants of the contour dynamics. These become accessible by imaging of fluorescently tagged fusion proteins and by more advanced methods, such as knock-sideways and optogenetic approaches. Here, existing mechanistic models may provide a useful basis and might merge into a joint modeling concept. In this article, we concentrate on the first aspect of the above agenda. We provide a mathematically well-defined approach that allows for a detailed analysis of the complex, multifaceted contour dynamics of amoeboid cells. A key ingredient is the concept of regularized flows between contours that define an evolution of virtual markers in time. Using contour flows, we define a coordinate system on the evolving contours and approximate local quantities of interest. While the strongly regularized flow is used to define trajectories of virtual markers over the entire time span, the weakly regularized flow is used to obtain information on local membrane changes, which is mapped subsequently onto the global flow representing the coordinate system. This separation between global and local flows is an essential feature of our approach. Established approaches to describe virtual markers on an evolving contour most commonly include level set methods, e.g., in, where the cell contour dynamics was additionally decomposed into a translation of the entire cell and the deformation of its contours. In, the LSM was compared to a mechanistic spring model penalizing a dense concentration of virtual markers. While the mechanistic model provides better computation times than the LSM, it shows limitations regarding topological mapping violations during strong shape deformations. Alternatively, electrostatic field equations were successfully employed, tackling mapping violation issues while providing better computation times. However, it does not provide trajectories of virtual markers over the entire time interval in its current form. In, a mapping was chosen which minimizes the sum of squared distances between virtual markers, while enforcing an evenly-spaced distribution of virtual markers. Our work aims at presenting a theoretical framework for the analysis of marker dynamics and combining the respective merits of the above approaches into a single method. In the spirit of previous approaches, we rely on the widely used concept of kymographs to graphically represent the space-time dynamics of different geometric quantities, such as the speed of membrane displacement or the local curvature, along the cell contour. In this context, we propose a novel criterion based on a single dynamic quantity for defining membrane expansions/contractions. Prior approaches to identify membrane protrusions relied on the simultaneous matching of multiple criteria, such as critical values of curvature, protrusion speed, and pseudopod lifetime or identified protrusion events as points in time only, without providing major protrusion properties, such as area growth rate, shape, and others. In, pseudopods were detected by using a hierarchical clustering algorithm in which individual membrane extensions are connected based on direction and continuity in space and time. Furthermore, image skeletonization on contours was used to identify and characterize pseudopods in an automated way. Unfortunately, all existing approaches have in common an undesirable blending of the protrusion-defining criteria with their numerical implementation. This makes it difficult to discern biological effects from numerical artifacts. We instead first define our criterion in mathematical terms and only subsequently implement it numerically, allowing us to control numerical errors and avoid artifacts. The methodology of this article is implemented in AmoePy, a Python-based toolbox for analyzing and simulating amoeboid cell motility. Furthermore, AmoePy features multiple data handling and analysis tools, an easy-to-use graphical user interface, and data files containing multiple experimental cell tracks in addition to simple artificial tracks which were used to additionally validate the algorithm. The article is organized as follows. We first develop the mathematical framework and introduce the concept of regularized contour flows. We then illustrate our approach in applications to experimental recordings of the social amoeba Dictyostelium discoideum, a widely used model organism for the study of amoeboid motility. Finally, based on the results of our analysis, we illustrate in the Discussion section how we envision the next steps towards a quantitative, data-driven model of amoeboid motility, based on a point process of the protrusive activity. Methods Data acquisition and image segmentation Experiments were performed with AX2 cells of the social amoeba Dictyostelium discoideum. As a marker for filamentous actin, cells expressed fluorescently tagged Lifeact. They were grown at 20°C in liquid culture flasks containing HL5 medium including glucose and 10 μ g/ml G-418 sulfate as a selection marker. Before each experiment, cells were harvested from culture flasks and grown in 25 ml overnight shaking cultures at 180 rpm under otherwise identical conditions. Afterward, nutrients were removed by centrifugation and washing of the cell pellet with Sørensen phosphate buffer at pH 6. Then, cells were resuspended in fresh buffer and droplets were formed in a Petri dish to initiate the streaming processes. For image acquisition cells were transferred after 5 hours to a glass bottom dish. During imaging, they were kept in Sørensen phosphate buffer at 20°C. Images were taken with a Zeiss LSM780 laser scanning confocal microscope at a frame rate of one image per second, using a 63× or 40× oil immersion objective. Fluorophores were excited at 651 nm and emission was recorded between 562 nm and 704 nm. For details see also, where the same data set was used in a different context. Fluorescence image were segmented using a modified version of the active contour algorithm described in. Based on this algorithm, we parameterized the cell boundary in each frame by a closed string of M = 400 equidistant nodes. As frames were taken at discrete time points t 0, …, t K −1 with equal time difference δt = t k +1 − t k = 1 sec, we denoted the discrete representation of the cell contour in a given frame at time t k as γ k with supporting points, …, ∈ R 2. In the result section, the data sets consists of K = 500 to 1000 time frames. For later reference, we set t 0 = 0 and t K −1 = T. Estimate of contour dynamics We used a real-valued smoothing spline for the x and y coordinates based on Gaussian process regression using a Poisson kernel, for details see S1 Text. This yielded a parametrization of the contour Γ k at time frame t k = k ⋅ δt Φ k : ×, these additional constraints were formulated as a mechanistic spring model, providing better computation times than the more commonly used LSM. However, it is mentioned that for strong shape deformations this mechanistic model easily fails because of mapping violations. This approach, as well as ours, is based on a cost functional minimizing the trajectories of virtual markers to the next contour while penalizing the distances of neighboring virtual markers. While in the mechanistic spring model the penalizing distance is measured in R 2, the space of contours, our approach measures the penalizing distance in = ∫ 0 2 π ‖ Φ k + 1 ) − Φ k δ t ‖ 2 μ k d θ = ∫ 0 2 π ‖ V k ‖ 2 μ k d θ. The normal flow from contour Γ k to Γ k +1 is the flow that departs from the first contour in the normal direction until it intersects with the second contour. The normal flow from Γ k +1 to Γ k shall be called the reversed normal flow from Γ k to Γ k +1. This is the unconstrained minimizer of F k. If there are no intersections of flow lines, it defines a one-to-one mapping between the two contours. In general, however, direct minimization of the functional F k does not yield a valid flow because of self-intersections, and as a consequence, the induced map is multiple-valued. We therefore need to regularize the flow. A natural requirement is that the flow tends to enforce non-uniformly distributed points on contour Γ k towards more uniformly distributed points on contour Γ k +1. We proposed to quantify the degree of non-uniformity of a distribution μ d θ by means of U = ∫ 0 2 π d θ μ. Since any distribution satisfies ∫ 0 2 π μ = 1 and μ > 0, the minimizer actually corresponds to the uniform distribution. Other measures of non-uniformity are possible, for instance the entropy S = ∫ 0 2 π μ log ) d θ. This kind of regularization has been proposed in by Otto, where the optimal flow is understood as a gradient flow of the entropy potential with respect to the Wasserstein transport distance of the marker density. Also very appealing, in this paper, we used the characterization in Eq, since it leads to a more readily tractable numeric quadratic minimization problem. In terms of the defining mapping ϕ k, the functional U reads U k = ∫ 0 2 π ∂ θ ϕ k 2 μ k d θ, as follows from Eq. The regularized flow is defined as the flow that minimizes a compromise between both cost functions ϕ k, λ = argmin ϕ k F k + λ U k, λ > 0. Note that H k = F k + λ U k depends on both, ϕ k and the measure μ k. When iterating over all contours, one needs to update the measure before optimizing the flow for the next time step. There are two end-member cases for the regularized flow: For large λ the optimal flow essentially immediately uniformizes the density of the initial contour. Thereafter, it is the uniform stretching flow that minimizes the mean square distances between the contours. This is precisely the coordinate flow defined before. For small λ the optimal flow allows for arbitrary local stretching rates to minimize the point-wise distance. Here the limit defines the regularized shortest path flow, respectively, the regularized reverse normal flow. Note that straightforward pointwise minimization of the flow distance from Γ k to Γ k +1 may lead to overlapping connections and hence singular mappings between the contours. If instead, we regularize with small λ, such overlaps are avoided. The virtual marker picture For numerical implementation, we discretized the cost functionals using the concept of virtual markers on the contours. The virtual markers are a discretized version of the Lagrangian coordinates. Since μ k is the transported density, the first cost functional for ϕ k in the Lagrangian point of view using Eq is given by F k = 1 2 π ∫ 0 2 π ‖ V k ) ‖ 2 d θ 0 = 1 2 π δ t 2 ∫ 0 2 π ‖ Φ k + 1 ) ) − Φ k ) ‖ 2 d θ 0, while the second functional using Eq is given by U k = 2 π ∫ 0 2 π | ∂ θ 0 χ k + 1 | 2 d θ 0. See S1 Text for details of the derivation. Both equations are well suited for a discrete numerical approximation for a given function f and initially equidistant θ 0, i = 2 πi / N with i = 0, …, N − 1 using ∑ i = 0 N − 1 f ≃ ∫ 0 2 π f d θ 0. If we now approximate the continuous mapping ϕ k by its discrete values on the virtual marker points θ k = with θ k + 1, i = ϕ k, then the first cost function may be approximated as F k ≃ F k = 1 N δ t 2 ∑ i = 0 N − 1 ‖ Φ k + 1 − Φ k ‖ 2 and the second cost function as U k ≃ U k = N ∑ i = 0 N − 1 | θ k + 1, i + 1 − θ k + 1, i | 2. For the entropy based measure of uniformity, consider a collection of points θ k,0, …, θ k, N −1 ∼ μ k on Γ k that are distributed according to the density μ k. Then for any function f, it is 1 N ∑ i = 0 N − 1 f ≃ ∫ 0 2 π f μ k d θ, yielding S k ≃ S k = 1 N ∑ i = 0 N − 1 log. In this discrete virtual marker approximation, the local dilation rate at θ i, k, also called the local dispersion, reads LD k, i = 1 δ t log θ k + 1, i + 1 − θ k + 1, i θ k, i + 1 − θ k, i. Please note that for infinitesimally small time steps another formulation of this rate is given by Eq. Especially for level set methods, this formula is more applicable. Finally, the discrete optimization problem is given by ϕ k, λ = argmin ϕ k F k + λ U k, λ > 0. Note that in the discrete optimization problem we do not pose any requirements on the space of transformations ϕ k ensuring condition Eq. If ϕ k − ϕ k = θ k +1, i +1 − θ k +1, i ≤ 0 for some k, we say that ϕ k exhibits mapping violations. Marker re-initialization for weakly-regularized contour flows In general, the distribution of virtual markers θ k ∼ μ k on Γ k depends on the initial distribution of virtual markers θ 0 ∼ μ 0 on Γ 0, since the density μ k results from the transport of μ 0 by the flow. As a consequence, functions derived from the local contour flow like, e.g., the local dilation rate along Γ k, may depend on the initial distribution on Γ 0. By re-initializing the distribution of virtual markers on Γ k for any k = 1, …, K − 1, this dependence may be removed. A natural choice is to re-initialize with the uniform distribution, i.e., using θ k + 1, i = ϕ k with ξ i = 2 πi for i = 0, …, N − 1 instead of Eq. To approximate the local flow ϕ = k =0,…, K −1 between contours, we thus solved the re-initialized optimization problem ϕ k, λ = argmin ϕ k F k + λ U k, λ > 0. with ξ = i =0,…, N −1. For the local dispersion, e.g., this resulted in LD k, i = 1 δ t log ϕ k, λ − ϕ k, λ ξ i + 1 − ξ i with no dependence on the initial distribution of markers on Γ 0. Algorithmic workflow We summarize the proposed numerical workflow: Given the segmented contours γ 0, …, γ K −1 as in Eq, determine the continuous representations Φ k defined in Eq satisfying the conditions in Eq. Determine contour based quantities like the curvature in Eq or the center of mass in Eq. To determine the coordinate flow, consider N equally spaced markers θ 0 = i = 0, …, N − 1 θ 0, i = ξ i = 2 π i N on the initial contour and choose a large λ value. Iteratively solve the regularization problem in Eq to determine the coordinate markers θ k +1 for Γ k +1 from the coordinate markers θ k for Γ k. Since both θ k +1 and θ k are approximately equally spaces, solving the minimization problem amount to choosing θ k +1,0. To determine the local flow ϕ = between successive contours, choose a small λ value and solve the regularization problems in Eq to determine the coordinates θ k +1, i = ϕ k,λ on Γ k +1 based on N equally spaced markers ξ 0, …, ξ N −1 on Γ k. Determine contour flow based quantities like the local dispersion in Eq or the local motion: LM k, i = ‖ V k ‖ = ‖ Φ k + 1 ) − Φ k ‖ δ t, see also Eq. Map all quantities, based on contour flow as well as contour only, onto the global flow. Numerical implementation and reproducibility All methods presented in this article are fully accessible as an open source Python-based toolbox AmoePy. Implementations of the above methods and additional routines necessary to reproduce the figures and results of this article are part of this toolbox. Furthermore, AmoePy contains: An object-oriented analysis tool to handle cell contours, i.e., to shorten, extend, or manipulate existing data sets and to extract additional geometric quantities, A python class to perform Gaussian process regressions in 2d and 3d with different selectable kernel functions, Multiple testing routines based on artificial test data and experimental data, see S1 Text and S4 Fig for more details, Several routines generating videos of cell tracks with corresponding kymographs and occurring expansion/contraction patterns, A detailed documentation generated by the Python documentation tool Sphinx, A graphical user interface able to compute and present kymographs AmoePy, as well as its graphical user interface, is updated regularly. Future outcomes of our ongoing research regarding for example cell segmentation routines and a forward model to simulate amoeboid cell motility will be also added to AmoePy. The algorithm starts with initializing equally spaced markers, representing the starting points of the flow. Subsequently, the optimization problem in Eq is solved contour-wise by gradient descent. Here, it is beneficial that the GPR also provides these gradients as a by-product, which decreases the computation time drastically; see S1 Text and S5 Fig for more details. Fig 2 shows the pseudocode to compute a regularized flow for a given regularization parameter λ. Being able to determine the regularized flow for a given parameter λ is the prerequisite to finally compute the global and local flows. These are based on the two regularization parameters λ glo ≫ λ loc > 0. The local quantities are then represented in the coordinate system of the global flow, yielding the kymograph representation. A pseudocode describing the computation of these kymographs is shown in Fig 3. Fig 2 Algorithm to compute regularized flows. Fig 3 Algorithm to compute curvature, local motion and local dispersion. In contrast to level set and electrostatic methods, the optimization approach presented here is not relying on the computation of intermediate field lines or contours for sufficiently small grid sizes. Notably, level set methods are computationally more expensive because of the time integration of virtual markers along these field lines. On the other hand, our algorithm contains additional steps such as the re-initialization of virtual markers via Gaussian process regression and the computation of kymograph quantities which may lead to slower computation times than other empirical mapping algorithms. A direct comparison of computation times of these methods is rather difficult since some algorithms rely on a varying number of virtual markers or a more image-based implementation. Moreover, the computation time depends on varying configurations of these methods, e.g., the resolution of the underlying grid in LSM, or the number of iterations/tolerance parameters used in optimization approaches such as ours. Unfortunately, a “biological true” mapping does not exist, with which the accuracy of each of those methods can be measured. Nevertheless, we provide the computation times of our algorithm “RegFlow” shown in Fig 2 on a standard computer, see S6 Fig. For a cell track of 500 contours and 400 virtual markers, the computation time for generating the mapping between two successive contours was measured for different regularization parameters λ. Not surprisingly, the computation time decreases for the end-member cases λ → 0 and λ ≫ 0, where the underlying functional is only defined by one leading term. For each choice of λ, the median of the computation time is below 2 s where most of the cases required sub-second computation times. Furthermore, no mapping violations occurred during the cell track despite larger shape deformations and membrane spikes. Therefore, our method has the potential to be used specifically for cell motility models that rely on a fast computation of stable virtual marker trajectories. Results Degree of regularisation controls distribution of virtual markers We applied our approach to time-lapse microscopy data of the social amoebae D. discoideum. Fig 4 illustrates the data acquisition process. For each time point t k, we obtained a sequence of segmentation points from a fluorescence image and Eq ) and their corresponding continuous representation Φ k and Eq ). The entire sequence of continuous contours is shown in panel, while the trace of the cell track and the center of mass trajectory are shown in panel. Fig 4 Cell trajectory of a persistently moving amoebae. In S7 Fig, estimations of continuous representations for different hyperparameters are shown. In contrast to Fig 4, the underlying snake of segmented points was obtained from noisy fluorescence image data resulting in many abrupt changes of the contour’s direction. In this context, the curvature for different contour estimates is displayed, highlighting the effect of underfitting and overfitting. Notably, the GPR provides an automated way of estimating the hyperparameters balancing the model’s complexity and its error residuals, see S1 Text for more information. This way, an accurate approximation of the cell contour can be obtained even for noisy data while preserving the main characteristics of its shape. In S8 Fig, the effect of different imaging frequencies on the resulting kymographs is shown. In this context, local motion kymographs are computed by using the entire microscopy data and down-sampled data sets based on every 2nd, 3rd, 5th, and 10th image/contour. While global characteristics of the cell track are captured even for a lower temporal resolution, the identification of local membrane changes becomes impossible. We therefore recorded each cell track with an imaging rate of one frame per second. See also S3 Fig, in which contour mappings for larger shape deformations are displayed. Here, the underlying cell track was recorded with an imaging rate of δt ≈ 3.13 s. The continuous representations Φ 0, …, Φ K −1 of all contours are the input to the optimization problem Eq to determine the regularized contour flow. Fig 5 shows the impact of the regularization parameter λ on the virtual marker trajectories. In the absence of any regularization, λ = 0), virtual markers are thinned out in some regions, while they are clustered in others. The case λ = 0 corresponds to minimizing the translation from the first contour to the next, i.e., each virtual marker on the first contour is linked to its nearest neighbor on the second contour. This may result in mapping violations θ k +1, i +1 − θ k +1, i ≤ 0 on the second contour. An example of mapping violations can be seen on the left-hand side in panel. As mentioned earlier, the flow obtained with λ = 0 is defined by the shortest path flow or equally the reversed normal flow. Thus, instead of taking the trajectories to the nearest neighbors on the next contour, one could also choose the shortest normal vectors from the second contour to the first one. Fig 5 Impact of regularization on the distribution of virtual markers for no regularization, weak regularisation with λ = 0.1, and strong regularisation with λ = 1000, illustrated on two frames with λ = 0.1), but to a lesser extent. Moreover, in the presence of regularization, virtual marker trajectories are interdependent, which results in trajectories without mapping violations. In the limit of strong regularization, the marker points remain uniformly distributed on every contour, while minimizing the overall distance between contours with λ = 1000). This makes the strongly regularized virtual marker trajectories an ideal candidate for a time-evolving reference frame and corresponds to the previously defined MCCS coordinate system. By choosing a strong regularization for the coordinate system, however, information on local contour changes is largely lost. Therefore, we used the strongly regularized case only to determine the coordinate system, while we determined local contour characteristics based on a re-initialized weakly regularized flow. The local characteristics were subsequently represented in the coordinate system obtained from a strongly regularized flow. In panel, the local motion obtained from the re-initialized weakly regularized flow with λ = 0.1 is shown for the same cell track as in Fig 4 and the entire time-lapse microscopy recording. The local motion clearly shows regions of fast-moving membrane parts at the leading edge and at the back of the cell. The curvature kymograph in panel shows characteristic lines of strongly convex and concave membrane parts. Inclined lines of curvature may result from adherent parts of the cell moving along the cell contour as well as shifting effects of virtual markers due to arc length changes. It is important to notice that a kymograph depends on the underlying time-evolving coordinate system. In contrast to the procedure mentioned above, one may also compute local characteristics along the global flow without re-initializing from a uniform distribution of markers after every time step. However, this is not recommended, because either local information gets lost or clustering and thinning effects of markers become too prominent ; see S9 Fig for global flows based on different regularization parameters and the resulting kymographs. As shown in S10 Fig, we further challenged our algorithm by computing a strongly regularized flow of the cell track from Fig 4 based on a few frames only. Even under such extreme conditions, the algorithm produced stable virtual marker trajectories, i.e., trajectories without mapping violations. Kymographs of local properties show characteristic patterns of amoeboid motility The kymographs of local dispersion, local motion, and curvature can be used to visualize, analyze, and quantify the expanding activity of a cell track. Note that the three quantities are closely related. Fig 6 shows cell tracks and corresponding kymographs for three different motility patterns: persistently motile cell; weakly motile cell; and an almost stationary cell. All kymographs are smoothed by a Gaussian filter with a standard deviation of three markers in space and a standard deviation of one contour in time. See S11 Fig for the same kymographs but without smoothing. Moreover, videos of all three cell tracks and their corresponding kymographs can be found in S1 – S3 Videos. Fig 6 Comparison of different cell tracks of Dictyostelium discoideum : persistently motile, weakly motile and almost stationary. The corresponding kymographs contain information on the local dispersion, local motion and... For the persistently motile cell, the LD kymograph shows strong activity in a band-like structure along roughly half of the cell contour, while the activity of local dispersion is less localized for the weakly motile cell and much less pronounced for the stationary cell. A similar scenario is seen in the local motion kymographs of the three cells. In broad terms, the local motion kymographs show more activity, e.g., areas of red and dark red color, than the LD kymographs. This is also apparent from a correlation plot of the two quantities. In the following section, we chose the local dispersion as a basis to identify expansions being a product of local velocity and curvature. Another reason to choose LD as the quantity to define expansions is that many patches of high activity in the local motion kymograph contain multiple LD areas. The LD allowed us to divide these patches of high local motion into single separated expansions with high LD rate. Virtual marker dispersion allows to identify and characterize expansions Using the persistently motile cell track in Fig 4, we describe next, how to use the LD to define expansion areas and expanding events. Based on the local dispersion kymograph in Fig 7A, we defined areas of medium and high expanding activity as well as medium and high contracting activity, see Panel. In this context, we determine thresholds for expanding activity by dividing the 90th percentile of all positive LD values of the kymograph into three intervals of equal length. For contracting activities the opposite thresholds were taken. By leaving out the largest and smallest values of the LD kymograph, the classification becomes less dependent on outliers. Additionally, we performed a prior smoothing of the kymograph as mentioned in the first paragraph of the previous section to reduce noise and, therefore, to reduce the number of small and separated patterns. Fig 7 From the local dispersion kymograph to expanding areas and expansion events. To highlight the events of the highest local expanding activity, we included positive local maxima of the LD kymograph in panel. Local maxima falling inside regions with high or middle expanding activity were depicted as bold dots. Using the time-evolving coordinate system obtained from strongly regularized flow, the expansion/contraction areas shown in panel are mapped back into the 2d plane of amoeboid motion, see panels and, respectively. As a result, we obtain an automated visualization of the expanding activity during amoeboid locomotion. The kymograph in panel clearly shows the trace of expanding activity at the leading edge, located initially at around 3 π /2 and then shifting towards π. At the same time, contracting activity occurs mainly at a distance of π from the leading edge. In panels and, one can nicely see the explorative dynamics of the expansions at the cell front and the stably retracting back of the cell, the so-called uropod, where dark blue areas indicate faster contractions. Analogous graphics for a collection of motile and stationary cells can be found in S13 and S14 Figs, each containing 12 cell tracks. In Fig 8, we present a close-up of two sequences of cell contours. The core expanding areas that shape the evolving cell contour can be seen clearly, e.g., in panel. The events of the highest expanding activity seem to drive the expansion in many cases. Panel illustrates strong contracting activity at the uropod, and the contraction of the membrane between two nearby expansions. The opposite effect can be seen in panel at the back of the cell, where a concave region between two convex contractions is identified as expansion. These patterns nicely illustrate the concept of local dispersion, being a product of the local velocity of virtual markers and the curvature along the contour segment. Fig 8 Expanding and contracting areas with corresponding expansion events. In S15 Fig, every identified pattern with minimal growth time Δ t ≥ 3 is shown for the underlying cell track. Statistical analysis of motility patterns In this section, we illustrate the ability to statistically analyze a cell track based on our regularized contour flow approach. We used the persistently motile cell track for illustration. Fig 9A shows the local dispersion kymograph of the persistently motile cell divided into four different phases. Until t = 200 s, the cell moves upward with well observable expansions roughly between 1.1 π to 0.2 π, while the uropod is slightly above π /2. Then, the cell begins a phase of reorientation that lasts until t ≈ 280 s, where larger expansions occur also at the former back of the cell. Subsequently, the cell changes its direction downward toward 3/4 π to π. In the last phase, the cell moves to the right-hand side by creating expansions at the front left, front right, and again front left of the cell. See S1 Video for a better understanding of the cell track. Fig 9 Statistical analysis of example cell track. We analyzed the expanding and contracting areas shown in Fig 7C and 7D with respect to the activity level, duration, and position along the cell contour. In addition, we investigated the differences between expansions and contractions. Fig 9B displays the area growth of expansions and contractions for high activity. The identified expanding and contracting areas are naturally partitioning by the sequence of contours into smaller ‘slices’. We defined the area growth of an expansion/contraction as the area of the slice divided by the frame rate δt. We observed that the overall change of cell area attributed to expansions of high activity is substantially larger than for contractions of high activity. This illustrates that the cell motility of this cell track is driven by a higher number of fast expansions, and a small number of fast contractions. Since in broad terms, the total area gain balances the total area loss, it further illustrates that area loss is to a larger extent attributed to slower and steadier contractions than it is for expansions. After the second phase, when the cell has completed reorientation, the area change for both, expansions and contractions increased and even more so at the beginning of the last phase. Finally, in panel, the number of simultaneous expansions and contractions is shown. In the first phase of the upward moving cell, the number of expansions is much higher than the number of contractions. In addition, we determined the fraction of time fT exp>2 and fT contr>2 with more than two simultaneous expansions and contractions, respectively. In the first phase, it is fT exp>2 = 0.146 vs. fT contr>2 = 0.035. In the following phases, these fractions increase for contractions: fT contr>2 = 0.198; 0.195; 0.341, whereas for expansions the fraction is slightly smaller in the second phase and larger in the last two phases: fT exp>2 = 0.123; 0.207; 0.217. This illustrates that the increased activity, as seen in panel, goes along with an increased number of expansions and contractions. Moreover, this indicates a more explorative character of the cell motion in phases three and four, while the cell seemed to be more stabilized during the first phase. Fig 10 gives further insight into the expanding activity. Panel shows the distribution of LD values of all virtual markers within expanding and contracting areas with high activity. In other words, the local dispersion distribution shows only values that are larger than the thresholds for high expanding activity or smaller than the threshold for high contracting activity. The distribution of the LD of expansions further extends towards large values than the corresponding distribution of contraction towards small values. Fig 10 Statistical analysis of example cell track. In panels and, the distributions of local motion and the curvature are shown for all virtual markers within expanding and contracting areas of high activity. For the local motion, we observed major peaks around 0.29 μm / s and −0.21 μm / s for expansions and contractions, respectively. Minor peaks correspond to inward expansions and outward contractions discussed in the previous section and shown in Fig 8, and a blue contracting area within an expanding region in panel ). In line with this observation, minor peaks of concave curvature and major peaks for convex curvature are shown. Fig 10D shows the distribution of high activity expansions in direction of the moving cell. We identified two peaks in direction of the cell movement. Another peak is located at the back of the cell. A similar behaviour was presented for pseudopods in, where two different types of pseudopods were distinguished: splitting pseudopods and de-novo pseudopods. By comparing the correlation between the growth time and the area of expansions and contractions in panel, we observed that expansions possess an area often twice as large as contractions with similar growth times. This indicates the difference between the faster and more explorative character of expansions at the cell front and the slower and stably retracting character of the uropod. This is also in line with the corresponding activities shown in Fig 9B. Finally, in panel the distribution of growth times is shown for both, high activity expansions and contractions. Note that we used the term ‘growth time’ for both, expansions as well as contractions, owing to the fact that also contracting areas can be moving in an outward direction, as discussed earlier. The majority of growth times fall inside a range of 0 s to 10 s. Nevertheless, there are patterns, especially long persistent uropods, with growth times much larger than the range presented in these histograms. The average growth time of pseudopods observed in is much higher than the growth times of expansions presented in this work. This is not surprising, since our definition of expansions also takes short-lived objects into account. For example, the average number of expansions per minute for the persistently motile cell track is much higher than the average frequency of pseudopods per minute as observed in. Additionally, concave regions between two contractions as in Fig 8A were detected as expanding areas as well, which raises the total number of expansions. See S13 and S14 Figs for similar graphics of a collection of 24 cell tracks, also containing the other two tracks from Fig 6. Application to other kinds of cell motility In this section, we demonstrate the flexibility of our method to study other kinds of cell motility. To this end, we extracted sequences of cell contours from videos of early embryonic killifish cells and keratocytes cultured from Central American cichlids. While the images of the embryonic killifish cells were obtained from fluorescence microscopy, bright-field microscopy was used to record the keratocytes. As before, the images were segmented by using a modified version of the active contour algorithm described in. In Fig 11, three cell tracks for both applications, embryonic killifish cells and keratocytes, and corresponding local dispersion kymographs are shown. In panels and, protrusion-driven cell motility can be observed for the embryonic killifish cells. Moreover, rotating waves around the leading edge can be seen in panel and in the last third of panel as diagonal lines. In the chosen parametrization, right upward diagonals indicate counterclockwise rotations of protrusions while right downward diagonals indicate clockwise rotations. Notably, the switching between these kinds of locomotion can be nicely seen in panel at t ≈ 630. In addition, we refer to the video accessible on showing the cell track from panel with dominant circular movements. Fig 11 Application to other kinds of cell motility. On the contrary, keratocytes possess a steady and persistent type of cell migration with only minor shape deformations. However, keratocytes can also show a more crawling kind of cell motility depending on the adhesion strength. In, cell track recordings for different adhesion strengths are provided: intermediate adhesion strength ), low adhesion strength ), and high adhesion strength ). For low and intermediate adhesion strength, persistent cell track can be observed with a slightly higher local dispersion at the cell front for the case of low adhesion strength. For high adhesion strength, the cell migrates slower and exhibits larger cell shape deformations. Again, diagonal lines in panel indicate circular movements as described earlier. Due to segmentation/mapping difficulties resulting from jumps in the video recording, pronounced artifacts can be seen as vertical lines at t = 360 s and t = 750 s. These test applications underline the flexibility of our algorithm, handling contours obtained from fluorescence images as well as bright-field recordings. Moreover, the underlying data was recorded with a lower temporal resolution, 5 s per image compared to only 1 s in our data. For the case of embryonic killifish cells, which possess local contour changes comparable to our data sets, a temporal resolution of 5 s is relatively low. This can be nicely seen in panel. Since the movement of keratocytes is much slower with less prominent contour changes, kymographs with relatively high resolution can be acquired for a sufficient temporal resolution of 5 s. This shows the feasibility of our algorithm for different imaging frequencies, see also S8 Fig. Finally, the local dispersion kymographs of these test cases show distinct differences from previous kymographs regarding amoeboid cell migration. This indicates the potential of our algorithm for classifying different kinds of cell motility. Discussion With the ever-increasing amount of live cell imaging data and the continuously growing computational power, computer-automated techniques to analyze the morphology of cells have steadily developed over the past two decades. In particular, in cell motility research, morphological characteristics are commonly used to pinpoint phenotypic differences between mutant cell lines thus highlighting the mechanistic role of individual components of the underlying signaling pathways. While many static measures of cell shape have already been introduced early on, dynamic measures that quantify the temporal evolution of the cell shape proved to be more difficult to implement. First attempts focused on temporal changes of the projected cell area to deduce overall protrusion rates, for an example see. These approaches were later refined by local measures of cell boundary motion along selected line segments perpendicular to the cell border. Also, local space-time plots have been defined in this way. However, in all these cases, the direction of interest or the local placement of the kymograph had to be chosen manually, which severely limits a reliable long-time tracking of more complex cell shapes and introduces an arbitrariness related to the manual processing. The most promising approach to overcome this limitation relies on an active contour, a closed chain of connected nodes that is placed along the cell perimeter. Different rules have been proposed to propagate the markers from one contour to the next. In some cases, the distance between virtual markers is kept constant and markers are added or removed as the contour evolves. Other approaches that are inspired by mechanical spring models or concepts from electrostatics keep the number of markers constant and allow for local variations in the marker spacing. Here, we can distinguish two limiting cases. On the one hand, equidistance is enforced and markers on adjacent contours are connected in a one-to-one mapping by minimizing the sum of square distances between pairs of connected markers. On the other hand, markers are propagated from one contour to the next in a normal direction while the marker spacing evolves without constraints. The latter approach has been implemented using a level set method to cope with problems related to finite time sampling. However, high computational costs and the rapid buildup of highly uneven marker distributions limit the use of the level set method in practical applications. In this article, we have introduced a family of marker flows that incorporates these different cases into a general framework. In particular, the regularization that we introduced in Eq includes the two extreme scenarios described above as limiting cases. In the limit of large λ, we obtain an equidistant mapping, whereas, in the limit of small λ, we approach the shortest path flow, respectively, the reverse normal flow. Tuning λ allows us to systematically shift between these two limits. Once a flow of virtual markers is computed on the evolving cell contour by any of these methods, it defines a coordinate system, in which different local quantities can be displayed, such as curvature, membrane displacement, or the intensity of a fluorescently tagged membrane-associated protein. Essential to our approach is the clear separation of local quantities derived by weakly regularized flows between two consecutive contours and the coordinate system which is based on a single strongly regularized flow onto which each quantity of interest is mapped. This way, trajectories of each quantity can be obtained for the entire time period. Note that for all of these coordinate choices it is generally acknowledged that the dynamics of the virtual membrane markers do not reflect the motion of specific membrane lipids or proteins, as the membrane itself is a very complex and dynamic structure. In particular, lateral flows may occur due to membrane recycling, so that the dynamics of individual molecules or domains in the membrane do not necessarily correspond to morphological changes and will prevent a one-to-one mapping of molecular markers on adjacent contours. Amoeboid motion is primarily driven by localized membrane protrusions, so-called pseudopodia. Identifying and tracking pseudopodia has thus been an important focus of the morphodynamic analysis of amoeboid cells. The first substantial pseudopod statistics were generated by computer-assisted manual image processing, relying on the expert judgment of the investigator. From this, a first automated software routine for pseudopod tracking was developed and successfully applied also to analyze the chemotactic navigation of amoeboid cells. It relies on a complex decision tree that defines pseudopodia based on a sequence of threshold criteria applied to the local curvature, the virtual marker movement, and the local area change. In this way, the frequency and direction of pseudopod formation, their sizes, lifetimes, and other quantitative measures were extracted. While successfully providing a first quantitative database of pseudopod characteristics, this approach has the drawback that it requires the choice of several parameters that are tuned to the characteristic properties of pseudopods in starvation-developed D. discoideum cells. If cells display protrusions with a more diverse range of shapes and time scales, a reliable tracking is difficult to achieve with this approach. Later, a more compact criterion for the detection of localized protrusions was proposed. It relies on thresholding a distance measure between the current position of virtual markers and the cell boundary at a later time point. The calculation of this distance measure, however, lacks a clear underlying definition and is computed in an ad hoc fashion for the specific data set : First, each virtual marker is mapped from its current position onto the closest point on the future cell contour. As this generates a highly non-uniform distribution of target markers, with protrusive areas particularly poorly covered, the target markers on the new contour are then redistributed by two successive smoothing steps, using averaging windows of specific sizes. The time interval between the successive contours for the distance projection, as well as the smoothing parameters for redistribution of the target markers, were hand-picked by the investigator. Note, however, that this could be envisioned as one step in an iterative procedure to minimize our cost functional. In the present work, we introduce a novel approach to define, identify and analyze localized expansions on dynamically evolving contours of amoeboid cells. expanding areas are defined via a single threshold value. In contrast to previous approaches, we chose the virtual marker dispersion as the underlying quantity, since it combines information on both, the marker displacement and the local curvature. The marker dispersion is mathematically well defined by Eq and does not require additional empirical smoothing steps. Based on this criterion, we not only detect individual expansion events but we capture the entire shape and the complete temporal evolution of an expansion in a fully automated fashion, see Fig 8 and S15 Fig for example. An implementation of the methodology, obtaining kymographs from regularized flows in general and detecting expansion/contraction patterns from these kymographs in particular, are fully accessible and well documented in our software Package AmoePy. We also provide the data of multiple cell tracks and simple artificial test cases on which the algorithm was validated. Finally, all figures and results from this article can be easily reproduced in AmoePy. As outlined in the Introduction, the overall aim is a quantitative, data-driven model of amoeboid motility. The presented theoretical framework is a first step in this direction. Because of its rigorous mathematical formulation, its efficient avoidance of mapping violations during larger shape deformations, and its moderate computational costs, it is a suitable choice for such a model. We envision that point events of high expanding activity may be used to define a point process in the space-time coordinate system. To reflect the often observed persistence in motility, so-called self-excited Poisson cluster processes or Hawkes processes may be favorable choices. The point process can serve as a skeleton for expansion activity that is ‘completed’ to a random realization of a kymograph, based on the statistics of a local quantity. We illustrated this idea in Fig 12, where we used the local motion statistics to reconstruct a local motion kymograph. The idea is to use such realizations of kymographs to reconstruct a cell track and eventually to assimilate the time-lapse microscopy data into a mathematical model of amoeboid motility. Fig 12 Future outlook. Supporting information S1 Text Supplementary methods and supporting computations. Click here for additional data file. S1 Fig Three-dimensional space–time tube of contours, where consecutive contours are stacked onto each other. Click here for additional data file. S2 Fig Comparison of virtual marker mappings obtained with different regularization schemes, using the distances between neighboring virtual markers in R 2 and S 1, respectively. Click here for additional data file. S3 Fig Selection of contour mappings under large shape deformations with corresponding local motion kymograph. The underlying cell track was recorded with an imaging rate of δt ≈ 3.13 s. Click here for additional data file. S4 Fig Collection of 13 artificial cell tracks with corresponding kymographs showing local dispersion, local motion, and curvature. In the figure at the top of each page, the period of time of several cell tracks was shortened for illustrative purposes due to overlapping contours. Click here for additional data file. S5 Fig Schematic overview of an algorithm to obtain coordinate markers from solving the optimization problem as in Eq. See also S1 Text for more details. Click here for additional data file. S6 Fig Computation times of “RegFlow” algorithm shown in Fig 2 for different regularization parameters and contours. Click here for additional data file. S7 Fig Cell contour based on noisy fluorescence images estimated via GPR for different hyperparameters and corresponding curvature. Click here for additional data file. S8 Fig Comparison of local motion kymographs obtained with different imaging frequencies: δt ∈. Click here for additional data file. S9 Fig Comparison of global flows in cases of no, weak and strong regularization. Click here for additional data file. S10 Fig Test scenario of a cell track, where the underlying coordinate system is based on only 8 out of 500 contours. Click here for additional data file. S11 Fig Kymographs as in Fig 6 without prior smoothing. Click here for additional data file. S12 Fig Correlation between local dispersion and local motion. The correlation is shown for the cell track in Fig 6 : Persistently motile, weakly motile and almost stationary cell. Click here for additional data file. S13 Fig Collection of 12 cells with high and medium motility and different grades of persistence. For each track the kymographs of local dispersion, local motion and curvature are shown, followed by plots as in Figs ​ Figs9 9 and ​ and10. 10. The cells are sorted in descending order regarding the area of the entire contour track. Click here for additional data file. S14 Fig Collection of 12 stationary cells. The file is structured as in S13 Fig. Click here for additional data file. S15 Fig Collection of identified expanding areas and events of high intensity for the persistently motile cell. Only features with minimal persistence length Δ t ≥ 3 are shown. Click here for additional data file. S1 Video Persistently motile cell. Cell tracks in all videos are shown at tenfold speed. Click here for additional data file. S2 Video Weakly motile cell. Click here for additional data file. S3 Video Stationary cell. Click here for additional data file. 