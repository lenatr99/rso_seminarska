 Alternative synonymous codons are often used at unequal frequencies. Classically, studies of such codon usage bias attempted to separate the impact of neutral from selective forces by assuming that deviations from a predicted neutral equilibrium capture selection. However, GC-biased gene conversion can also cause deviation from a neutral null. Alternatively, selection has been inferred from CUB in highly expressed genes, but the accuracy of this approach has not been extensively tested, and gBGC can interfere with such extrapolations. It is therefore critical to examine deviations from a mutational null in a species with no gBGC. To achieve this goal, we implement such an analysis in the highly AT rich genome of Dictyostelium discoideum, where we find no evidence of gBGC. We infer neutral CUB under mutational equilibrium to quantify “adaptive codon preference,” a nontautologous genome wide quantitative measure of the relative selection strength driving CUB. We observe signatures of purifying selection consistent with selection favoring adaptive codon preference. Preferred codons are not GC rich, underscoring the independence from gBGC. Expression-associated “preference” largely matches adaptive codon preference but does not wholly capture the influence of selection shaping patterns across all genes, suggesting selective constraints associated specifically with high expression. We observe patterns consistent with effects on mRNA translation and stability shaping adaptive codon preference. Thus, our approach to quantifying adaptive codon preference provides a framework for inferring the sources of selection that shape CUB across different contexts within the genome. Keywords: codon usage bias, biased gene conversion, weak selection, translation Introduction Codon usage bias, where synonymous codons are not used in equal frequencies, is well documented across species from all three domains of life. Alternative explanations for CUB have played a central role in the decades long neutralist–selectionist debate. On the one hand, a purely neutral framework has been proposed in which CUB arises simply as a consequence of mutational bias. This framework can explain a large proportion of variation in CUB across taxa, including bacteria, archaea, plants, and animals, where mutational bias has presumably shaped GC% at third codon positions to vary from near zero to nearly 100% across species. Across this range, we see a corresponding shift in CUB such that the use of the same codon can go from near zero to near 100% use as genomic composition changes. This process can even explain intragenomic variation if there are different mutational biases in different genomic regions. On the other hand, it has been proposed that selection operates on synonymous mutations because they affect a variety of processes, some linked to transcription and translation. For example, the translational selection model is often invoked to explain observations where commonly used codons match the most abundant tRNAs. More generally, transgenes with “foreign” codon usage profiles often show reduced transcription or translation rates. Functional support for the selectionist perspective also comes from the discovery of synonymous mutations that cause disease, which also indicates the importance of identifying and understanding the drivers underlying adaptive codon use. One way to distinguish between neutral and selectionist models is to develop a framework that can accurately identify the action of selection in the presence of neutral/mutational bias. In this framework, deviations from the neutral pattern of CUB would capture the signatures of natural selection driving adaptative CUB. Therefore, this framework relies on the ability to accurately define an unbiased neutral expectation such that deviations from neutrality can be accurately characterized. One approach is to measure nucleotide content in genomic domains assumed to evolve neutrally, such as in introns, intergenic regions, and pseudogenes or use nucleotide biases at some codon third sites to predict others. In principle, between species comparisons can allow substitutional processes to be inferred, again often using sequences predefined as neutrally evolving. An alternative is to make no assumptions about mutation bias but instead to presume that selection must be stronger in highly expressed genes. The codon usage profile of the most highly expressed genes is then used to infer the optimal codon set and thence the degree of codon adaptation of any given gene, measured in terms of the gene’s usage of the “optimal” codon set. However, it is possible that genes with lower expression are also under selection to optimize their ability to produce sufficient protein product. Importantly, this pattern of selection may deviate from that in the most highly expressed genes, which may themselves experience very specific selective constraints that shape codon usage that are not imposed on most other genes in the genome, as supported by transgene studies. Hence, inferring adaptive codon preference from the profile of the most highly expressed genes could potentially reflect a tautology that fails to capture the more general profile of natural selection that shapes codon use in most genes in the genome. Nonetheless, such a methodology has claimed support from observations that synonymous rates of evolution are lower in genes with high CUB. However, this conclusion may well, at least in some incidences, be an artifact of inaccurate estimation methodology that is itself skewed by CUB. Although these methods appear logical, GC-biased gene conversion presents a major challenge. In this process, an AT:GC mismatch is preferentially repaired in favor of the GC residue during heteroduplex mismatch repair through meiotic double strand break repair. For example, in the human genome A:G mismatches are repaired to G about 70% of the time during noncrossover recombination events. gBGC appears to be an important force that can mimic the influence of selection, but which can operate on any sequence, regardless of whether it is considered to be neutral or under selection. Importantly, the level of recombination also increases with GC content, which may be a consequence of gBGC or caused by high GC. Regionalization of recombination hot and cold spots will, therefore, result in a correlation between GC3, the GC composition of introns, and the GC content of flanking sequence. There is also evidence for AT → GC fixation bias in GC-rich/high-recombining domains. These factors are likely to have led to the evolution of isochores, which means that the best prediction of CUB in the human genome is not a property of the gene but rather, the isochore within which the gene is found. The presence of gBGC represents a major problem for studies that rely upon measures of observed nucleotide content or substitutional profiles in putatively neutral sequence to provide a measure of mutational bias, as neither will reflect the underlying mutational process, even if the sequence class is neutrally evolving. Similarly, even if highly expressed genes are indeed subject to stronger selection, it is also possible that these genes show a shift in GC content independent of selection because they are more prone to strong gene conversion, perhaps due to being in domains of high recombination. Indeed, in humans, highly expressed genes tend to be GC rich and located in GC-rich isochores with high recombination rates. Given this, basing inference of adaptive codon preference on CUB in the most highly expressed genes could potentially be misleading. Attempts have been made to correct the substitutional profiles to account for biased gene conversion, for example, by examining A ↔ T, G ↔ C changes separately from AT ↔ GC changes. With transgene evidence indicating that high GC confers higher expression levels, these methods are problematic in ascribing all AT → GC fixation events to gBGC, potentially overlooking a major source of selection. An alternative method to determine skew from mutational expectations is one in which the mutational bias is more directly observed. Perhaps the “gold standard” is to have data from parent offspring trios. However, to date this only exists for a handful of species and can be noisy because this method usually only identifies a few mutations per trio, especially in species with small genomes. False-positive mutational inference is hence a problem for such methods. Consequently, mutation accumulation lines or analyses of mutational profiles based on rare segregating single nucleotide polymorphisms are more commonly used. For example, such studies have revealed that the mutational process is GC → AT biased in humans, which results in a predicted neutral mutational equilibrium that is strongly AT biased. This is also approximately independent of the GC content of the isochore, which suggests that codon usage is GC biased due to a fixation bias, rather than a mutation bias. More generally, when mutation-derived equilibria are compared against observed GC content, most genomes show higher GC3 than the neutral mutational predicted equilibrium GC. Even if we can infer the mutational process in a manner that is not confounded by gBGC, it remains very difficult to show that observed compositional profile deviations from a mutational null are due to selection. More generally, we can identify fixation bias as a deviation from mutational null. Moreover, even if the fixation bias appears adaptive because of its match to the tRNA pool, it is possible that the persistent influence of biased gene conversion skews codon usage and tRNA pools adapt to this skew not vice versa. Given the potential impact of various nonadaptive processes that can bias base composition, we suggest that it might be most instructive to examine patterns of CUB in species in which the role of gBGC is a priori thought to be minimal. This would allow for the impact of natural selection on CUB to be more cleanly characterized and the validity of common functional assumptions to be tested in a nontautologous fashion. Here we exploit the social amoeba Dictyostelium discoideum to implement such an analysis. Dictyostelium discoideum offers a compelling system for a number of reasons. The impact of gene conversion can be particularly problematic for inferences of selection on codon usage, but, although it is typically profound in mammals and birds, this is rarely the case in single-celled species. For example, the net bias in yeast has been estimated from tetrad analysis to be weakly in favor of AT → GC repairs. Second, it has one of the most extreme base composition biases recorded for eukaryotes to date, second only to the human malaria parasite Paramecium falciparum. It is logical, therefore, to assume that the impact of gBGC to counteract the strong GC → AT-biased mutational profile must be small. Moreover, the extreme base composition bias provides for a clear and strong expectation for the neutral pattern of CUB driven by mutation–drift. Finally, we can exploit the available genome sequences from 67 strains that enable analyses of patterns of SNP variation, which allow for inference of mutational profiles and rates and the signatures of selection on synonymous changes. We can also exploit the extensive expression data available, which allows us to characterize how patterns of CUB relate to the expression properties of genes. To achieve this goal, we first investigate whether we can discern any of the classical fingerprints of gBGC conversion in D. discoideum, namely a GC-recombination correlation and local GC correlations. Having found no coherent evidence of gBGC, we next defined the mutation profile from SNPs, which allows us to infer the expected neutral pattern of codon usage. As expected, AT mutation bias dominates the pattern of CUB. However, accounting for the neutral pattern allows us to infer the influence of selection driving the relative use of synonymous codons away from the neutral expectation, which we interpret as providing a measure of the direction and strength of selection. Using these measures of “adaptive codon preference,” we test whether classical expectations of drivers of CUB hold and whether the pattern differs from what would be inferred using alternative approaches. In particular, we ask whether we can recover the expected correlation between our measure of adaptive codon preference and levels of gene expression, which provides a rare direct test of the hypothesis that selection is stronger in highly expressed genes. To understand how the pattern of selection on codon usage varies by context, we compare the patterns of adaptive codon preference with the shifts in CUB associated with levels and conditionality of gene expression and with variation in codon position within genes. Together our results show that deviations from the neutral pattern of codon use provide a clear inference for how selection shapes the use of alternative codons and how this pattern of selection changes across contexts. Finally, we show that this pattern is similar to but deviates from the pattern that would be inferred solely based on the association with high expression. Results gBGC Has Little Impact on GC Composition in D. discoideum In mammals, local biased gene conversion hotspots can cause CUB to vary across the genome and reflect the local composition in the genomic region where it is found. To determine whether gBGC also introduces heterogeneity into patterns of codon usage across the D. discoideum genome, we implemented five complementary analyses. In the first, we used a sliding window analysis to examine variation in GC content across the genome. GC content is largely evenly distributed across all chromosomes apart from a few peaks that are associated with genomic regions enriched in transposable elements. After removing the areas from small sections of chromosomes 1 and 6, we find that there is no relationship between GC content in surrounding noncoding regions and the base composition of coding regions within each window. These results indicate that processes shaping global, rather than local, base composition account for GC content and potentially synonymous codon usage in coding sequences. Second, we examined the relationship between variation in the local recombination rate inferred from natural sequences and local GC content. We found no evidence for an association between the number of recombination events in a region and the GC content of that region across the whole genome or on any of the individual chromosomes. Third, we implemented a gross-scale test based on the observation that the proximal half of chromosomes tend to show more crossover events than the distal half. For this, we used total GC and GC3 of genes in each region and find no difference between genes located on the proximal or distal halves of chromosomes for total GC or GC3. Fourth, we tested whether the proportion of GC in introns explains total GC or GC3 proportion in exons and find that intronic GC explains only 0.4% of the variation in GC3 and <0.01% of the variation in total GC. These results indicate that there does not appear to be a strong global process such as gBGC that simultaneously modulates the intronic and exonic GC. Finally, we examined whether the frequency spectrum of AT → GC SNPs differed from the frequency of GC → AT SNPs in introns and find no difference in any properties of the allele frequency spectrum. gBGC would be expected to shift the frequency distribution of AT → GC SNPs above that of GC → AT SNPs, and hence we see no evidence for its influence here. Most Variation in Synonymous Codon Use Is Neutral To characterize the expected neutral pattern of codon usage, we modeled the expected distribution of codon frequencies at equilibrium base composition, which essentially reflects mutation–drift balance. Logically, the relative frequency at which alternative synonymous codons are used will reflect the balance of mutational bias pushing codon use toward that expected at GC eq and selection pushing away from that expected at GC eq. Therefore, to characterize the expected neutral pattern of codon use, we first needed to establish the pattern of mutation between nucleotides. Mutation accumulation lines have previously been used to investigate the mutation rate in D. discoideum. However, the conclusions were drawn from a very small number of mutations and hence provide limited information on the relative rates of different types of mutational change. To overcome this issue, we instead used estimates based on rare segregating variants from regions evolving under neutrality or close to neutrality. SNP data from noncoding regions of 67 D. discoideum natural strains were used to extract information about the underlying mutational process and compute the nucleotide substitution matrix. The estimated substitution matrix is remarkably stable whether it is based on intergenic or intronic SNPs, and hence, we use the combined estimates. This analysis reveals that transitions and interclass mutations are much more common toward AT than away from it and will thus drive down GC content as mutations arise and drift to fixation. Fig. 1. Nucleotide substitution matrix. For each SNP, variants were classified as ancestral or derived. Derived variants were considered mutations from the ancestral... Genomic GC eq was calculated from the pattern of relative mutation rates using a system of linear equations. This analysis predicts a GC eq content of approximately 12.2%, which is very close to the value observed in noncoding regions. This suggests that GC content of noncoding regions is close to equilibrium, although the role of selection on some noncoding features and/or processes like dinucleotide mutation biases presumably result in a slightly higher GC content. In contrast, GC content in coding regions is considerably higher than both GC eq and GC at non-CDSs. This suggests that recurrent selection is opposing the strong mutational bias toward AT accumulation in CDSs. This is perhaps expected since protein function is determined by amino acid composition, and most amino acids require codons with at least one G/C. This is supported by the fact that relative GC content at position three is lower than that at other codon positions. Indeed, if we remove the two amino acids that have no alternative codon options, the GC content at position three is 12.2%, which exactly matches the expected GC eq value. Consequently, we see that the overall pattern of codon use is hugely biased toward the AT-richest codons, with most frequently used codon for every amino acid and stop signal always being one of the most AT-rich codons. Hence, it appears that selection on synonymous codon usage does not show an overall bias toward AT or GC ending codons such that their overall use matches GC eq. We used the estimated GC eq value to calculate the expected synonymous codon frequencies under neutrality, which assumes that codon use is simply a product of base composition probabilities at each position of a codon. We then rescaled expected relative codon usage to the frequency of the amino acid they encode to obtain relative synonymous codon frequencies excluding stop codons and amino acids encoded by only one codon. The expected distribution of relative synonymous codon frequencies explains a remarkable 83.3% of the variation in the observed relative codon frequencies. Fig. 2. Base composition at mutational equilibrium explains most of the variation in the relative frequencies of synonymous codon usage. The solid line represents the best-fit relationship are assumed to reflect the action of natural selection. However, it is possible that our model of expected codon frequencies at mutational equilibrium is an oversimplification of the neutral expectation. For example, if more complex patterns of dinucleotide or trinucleotide mutations occur, the probability of a given nucleotide triplet could be more than the simple “sum of its parts.” This would be particularly important at repeat-rich DNA sequences, because the repeats increase the chances of polymerase slippage during DNA replication. Therefore, we tested whether trinucleotide combinations, which are commonly found in the D. discoideum repeat-rich genome, deviate from the predicted product of expected nucleotide frequencies under mutational equilibrium. The frequency of trinucleotide combinations under neutrality was estimated by counting the number of each in noncoding regions in all three frames. These counts were then treated as pseudocodons to obtain synonymous codon frequencies under neutrality. The synonymous codon frequencies of these neutrally evolving pseudocodons can be largely predicted from the frequencies expected at mutational equilibrium, suggesting that mutational processes are mostly acting on a pointwise manner. The deviations of the pseudocodon frequencies from that expected at mutational equilibrium should reflect mutational processes such as biased insertion/deletion events. These processes are presumably responsible for the fact that the relative frequencies of these pseudocodons are far worse at predicting relative codon use than is the pattern predicted from the independent nucleotide mutation pattern. This is perhaps unsurprising because synonymous mutation is essentially constrained to be pointwise, whereas mutations in noncoding regions may be less constrained, allowing insertion/deletion processes to play a role. These findings suggest that deviations in codon frequencies from the neutral expectation based on base composition equilibrium are caused by selection shaping adaptive codon usage. Hence, codons used more frequently than the neutral expectation are considered evolutionarily “preferred,” whereas those used less often than expected are “unpreferred,” with the magnitude of the deviation from neutrality reflecting the relative strength of selection. This quantitative measure of “adaptive codon preference” is formally captured as a log fold change in the use of codons relative to the neutral expectation, calculated as the difference in the log 2 relative frequency of a codon observed in the genome from the neutral expectation. This approach therefore provides a quantitative measure of adaptive codon preference that is directly tied to the effects of selection, rather than being inferred from the pattern of codon usage in any class of genes. Based on this quantitative measure of adaptive preference, we can investigate the pattern of codon preference to see if there is any obvious structure. Of the 59 codons included in this analysis, 25 show positive deviations from neutrality, that is, are favored by selection. Of the 25 preferred codons, we see no obvious bias in terms of the nucleotide present at the third codon position. Furthermore, even if we restrict this analysis to the single most preferred codon for each amino acid, we do not see any pattern of preference for particular nucleotides, with an even split of amino acids having a most preferred codon that is GC and AT ending. This same basic pattern holds at 2-fold amino acids and 4-fold. Segregating Synonymous Polymorphism Reflects Selection on Codon Preference If our measure of adaptive codon preference is indeed adaptive, then mutations that lead to less preferred codons should be removed more rapidly by purifying selection than mutations that lead toward more preferred codons. We would therefore expect synonymous SNPs that lead to relatively lower preference codons to be less common than SNPs that lead to relatively higher preference codons. To test this prediction, we characterized the patterns of naturally occurring levels of synonymous SNP variation associated with each possible type of synonymous codon change using a set of 67 genome sequences. We then characterized the relative proportion of SNPs associated with each possible type of synonymous mutation and the relative preference of the codons created by those mutations. This approach is based on the hypothesis that the proportion of mutational variation within each codon can be predicted based on the expected relative fitness effect of those mutations. By modeling variation within each codon, this approach accounts for the variation in the preference of the “resident” codon and focuses on the pattern of preference caused by the mutations. We find that there is a relatively large positive correlation between the proportion of polymorphism in a given class of synonymous mutation and the preference of the resulting codon relative to the synonymous alternatives. Therefore, we see a clear signature of purifying selection within codons, with selection removing less of the mutational variation when it is associated with relatively more preferred codons and vice versa. Even for highly preferred codons, this means that SNP variation will tend to be associated with the least “harmful” class of mutation. Fig. 3. The relative level of polymorphism in each class of synonymous mutation is positively correlated to the relative preference associated with that synonymous change. “The relative level of polymorphism” is the log 10 difference between the... Conditional Selection Reduces the Magnitude of Codon Preference in Genes Codons in genes experiencing relaxed selection are expected to show a pattern of codon usage that shifts toward the neutral expectation, which corresponds to lower codon preference. To test this hypothesis, we calculated gene-level measures based on the preference of the codons within individual genes. This genic level analysis allows us to examine patterns across nearly all genes in the genome at the same time. Using these measures, we tested whether genes expressed only in the developmental part of the life cycle show a different level of codon preference compared with genes expressed in all parts of the life cycle. Previous analyses have demonstrated that the conditionally expressed genes show clear signatures of relaxed selection compared with the nonconditionally expressed genes, presumably because they are essentially neutral in most generations. Therefore, we would expect these genes to show a shift toward use of less preferred codons since that corresponds to a shift toward neutrality. Using the gene-level measures of codon preference for the sociality and nonsociality genes, we find that, as expected, sociality genes show a lower average preference than nonsociality genes. Hence, we see a clear pattern where genes experiencing relaxed selection show lower preference, which corresponds to a shift toward the neutral expectation. Highly Expressed Genes Show Higher Levels of Codon Preference Our analyses support the conclusion that adaptive codon preference reflects the direction and strength of selection on codons. Many previous studies have assumed that highly expressed genes experience stronger selection, and thus the pattern of CUB in highly expressed genes can be used to infer codon preference. However, it is possible that higher levels of expression impose specific selective constraints such that the pattern of codon use deviates from that expected solely due to a shift toward stronger selection. To address this question, we examined patterns of codon usage in the most highly and lowly expressed genes. For this, we compiled publicly available transcriptome data in D. discoideum and identified the 1,000 most highly and lowly expressed genes. We then counted the total number of times each codon appears in each class of genes and calculated the relative frequency with which each codon is used within each amino acid. For each gene set, we then calculated a measure of preference for each codon that is private to each gene class as the log fold difference between the observed relative codon frequencies within each gene set and the neutral pattern expected at mutational equilibrium. We also calculated gene-level adaptive codon preference to compare the average level of codon preference between expression classes. The private measures of codon preference calculated separately for the highly and lowly expressed genes closely match the genome-wide pattern. Furthermore, we find that the average size of the deviations from neutrality do not differ between lowly expressed genes and the overall genomic pattern, indicating that not only is the pattern of preference within lowly expressed genes highly correlated to the genome-wide pattern, it is also of a similar magnitude. However, we find that the deviations from neutrality in the highly expressed genes are significantly larger than the genome-wide pattern, indicating that the pattern of deviations from neutrality are similar, but the highly expressed genes are much further from neutrality. We see a grossly similar pattern by comparing the gene-level average preference of codons used in highly and lowly expressed genes to that of the remaining genes. However, although the difference is small, we find that lowly expressed genes show significantly lower mean preference than those with an intermediate level of expression. In contrast, we see that highly expressed genes show significantly higher mean preference than those with intermediate expression. These results indicate that the gross pattern of codon preference in highly and lowly expressed genes mostly mirror the pattern we see across all genes, with the primary differences being the magnitude of the deviations from neutrality and a shift in the central tendency. We also see clear evidence that lowly expressed genes are much more similar to the rest of the genes in the genome than are the most highly expressed genes. Adaptive Codon Preference Can Be Inferred from Highly Expressed Genes, but Not Perfectly Highly expressed genes show a pattern of codon preference that suggests they are under stronger selection. Since most studies base their characterization of codon preference on the pattern of codon use in highly expressed genes, we next examined whether the pattern of CUB associated with gene expression alone could be used to accurately recapitulate the pattern of codon preference derived from our evolutionary model. To test this, we calculated the log 2 fold difference in the relative use of each codon in the highly expressed class versus the lowly expressed class. We find that this “expression-associated codon preference” does indeed approximate the pattern of adaptive codon preference derived from our model. However, the two measures of codon preference are not identical, suggesting that selection on codon usage or differences in mutational processes that are specific to the context of highly expressed genes could affect codon use in relation to expression levels. For example, we see a large increase in the use of the AAC codon for asparagine in highly expressed genes compared with lowly expressed genes, but this is a codon that shows negative adaptive codon preference. We see a similar shift in the AGC codon for serine, where the expression-associated preference opposes adaptive preference. Interestingly, the nine codons that show positive expression-associated preference, but negative adaptive preference all end in a C or T. Similarly, we see a number of codons that show a negative expression-associated preference but positive adaptive preference, of which all are A or T ending. This suggests that codons with particular properties may be more likely to show opposing expression-associated and adaptive preferences. Indeed, if we look across all codons, we see a significant pattern wherein, of the 28 that show higher expression-associated than adaptive preference, 14 are C ending whereas only one is A ending. Likewise, of the 31 codons showing lower expression-associated preference than adaptive preference, 13 are A ending and only 2 are C ending, which is a significant departure from random. These patterns suggests that selection favors C ending codons and disfavors A ending codons in highly expressed genes, which is a pattern that does not appear when we consider deviations from neutrality across all genes, where codons that have a positive adaptive preference value are relatively evenly distributed across classes. It is also possible that codon use in highly expressed genes is different because they experience a different pattern of mutational input, perhaps mediated by transcription associated repair or mutational processes. Fig. 4. Adaptive codon preference is correlated to, but not the same as, codon preference derived from highly expressed genes. “Expression-associated codon preference” is defined by comparing codon use from the 1,000 most highly expressed genes... Deviation of Codon Preference in Highly Expressed Genes Does Not Reflect Differential Mutational Bias To understand whether the difference in codon usage in highly expressed genes could reflect a difference in the mutational profile, we examined the distribution of intronic SNPs in the set of highly expressed genes. Using these SNPs, we calculated GC eq for the 1,000 highly expressed genes and find a value very close to that calculated using all other intronic SNPs. Moreover, the observed number of SNPs per mutational class identified in the introns of highly expressed genes does not significantly deviate from the number predicted based on SNP density in the introns of all other genes. These results provide evidence that suggests that the pattern of expression-associated preference deviates from that of adaptive preference because of systematic differences in selection specific to the context of high expression, rather than a difference in mutation. As a result, measures of preference based solely on expression properties of genes can lead to inferences about codon preference that do not apply perfectly across all classes of genes. Furthermore, it suggests that the mechanisms that underlie selection for preferred codon usage are likely to be complex and multifaceted. Indeed, selection for codon usage has been proposed to be due to transcription, translation, or both. Codon Preference within Genes Suggests Effects on Ribosome Initiation and Elongation To understand why selection shapes patterns of adaptive codon preference, we examined how levels of preference change with genomic contexts thought to experience differential selection pressures. For example, codon usage within genes has been shown to affect interactions between the mRNA and ribosomes during translation. It has been suggested that less “optimal” codons are found in higher frequencies near to the start of CDSs in order to facilitate ribosome initiation and possibly slow elongation at the start of translation. To test this idea, we calculated the frequencies of codons at each codon position in genes, both from the beginning of genes and at the end of genes. At each position, we measured the average overall codon preference. At the beginning of genes, codon preference starts below the genome-wide average. Codon preference then increases steadily until it reaches the genome-wide average around codon 120, after which it asymptotes at a value that is higher than the genome-wide mean. We see a grossly similar pattern at the end of genes, where average codon preference is higher than the genome-wide average until about 50 codons from the stop codon, at which point it rapidly declines approaching the stop codon. Fig. 5. Patterns of codon preference across codon positions within genes. the average relative codon preference starting from the beginning of genes, and leading up to the stop codon. For highly expressed genes, codon preference is above the genome-wide average across all positions, and we see the same overall pattern in the change in codon preference that is observed across all genes at both the begging and end of genes. For lowly expressed genes, average preference is generally lower than the genome-wide average across all codons and shows the same overall change by codon position that we observe in highly expressed and all genes, though the shift in codon preference is of a lesser magnitude than what we observe in the other classes. These patterns are thus consistent with being driven by selection. Fig. 6. Patterns of codon preference across codon positions within lowly and highly expressed genes. In both plots, the lines represent splines and the points represent... To further test this idea, we calculated the relative density of synonymous SNP variation across codon positions to examine any signatures consistent with a shift in the balance of mutation and purifying selection, either due to changes in mutation rates or the strength of selection. We see a pattern of SNP density that follows the pattern of change in average preference at both the beginning and ends of genes. Importantly, the overall shift away from the use of preferred codons near the beginning and ends of genes is what would be expected under either relaxed selection or elevated mutation, but the signature of elevated purifying selection strongly suggests that the shift in codon preference is a consequence of selection on codon usage rather than an enhanced role for mutation and drift. This pattern also implies that codon usage in these regions is experiencing stronger purifying selection than elsewhere in genes given the reduced level of polymorphism. Fig. 7. Relative SNP density across codon positions at the beginning and ends of genes. The relative SNP density is the difference between the observed SNP density at a codon position and that expected based on the expected local... Selection on Codon Use Is Partly Explained by tRNA Availability Selection for codon usage has also been hypothesized to affect translation by favoring codons that match the availability of isoaccepting tRNAs. To test this idea, we exploited the finding that tRNA gene copy number is strongly and positively correlated to cellular tRNA levels. To link tRNA levels with patterns of codon use, we derived a new parameter that measures the relative synonymous codon adaptiveness. This index is based on dos Reis et al.’s codon adaptiveness. Because our interest is focused on usage of alternative codons encoding the same amino acid, w ij estimates synonymous codon adaptiveness for each codon relative to only the other codons encoding the same amino acid. We find that this relative codon adaptation index explains 40.7% of the variation in codon preference. Fig. 8. Codon preference is correlated to the relative codon adaptation index. Codon preference represents the deviation of relative codon frequencies from the neutral expectation at mutational equilibrium. In order to separate the processes shaping use of preferred codons into those that act via the interaction with the tRNA pool and those that appear to be independent of tRNA interactions, we use the relationship between codon preference and relative synonymous codon adaptiveness to partition adaptive codon preference into tRNA-dependent and tRNA-independent components. The tRNA-dependent component, therefore, corresponds to the expected pattern of codon usage given the square-root transformed values of w ij for a codon and the latter corresponds to the residual from this expectation. As such, the tRNA-dependent component reflects the influence of selection arising from tRNA adaptation on adaptive codon preference, whereas the tRNA-independent component captures other sources of selection. Use of Preferred Codons Increases Transcript Stability Selection can also drive patterns of codon use away from neutrality because it may favor the use of codons because of their effect on mRNA stability, which has been observed in a range of taxa, which we refer to as transcriptional selection. For example, such selection could arise because gene expression levels are determined by the rate of mRNA production versus the rate of decay, which can be tied to transcript stability. Since mRNA stability can affect steady-state mRNA levels, a relationship between codon preference and transcript stability could partly explain the observed increase in codon preference observed in highly expressed genes. To understand the link between codon preference and mRNA stability, we first estimated a measure of stability per site, defined as the global folding Gibb’s free energy divided by CDS length. Transcript stability increases with the average preference of codons in the transcript. Both tRNA-dependent and tRNA-independent average codon preference significantly increase transcript stability, but tRNA-independent preference is far more important than tRNA-dependent preference. Indeed, by separating total preference into tRNA-dependent and tRNA-independent components, we see that tRNA-independent preference explains far more variation than total preference, which suggests an adaptive role for tRNA-independent preference associated with transcript stability that is unrelated to adaptation to the available tRNA pool. This finding suggests that selection to optimize expression by usage of differential codons is, at least in part, achieved through increased transcript stability. Since this increased stability is primarily a result of tRNA-independent preference, this relationship provides a hypothesis for why selection favors tRNA-independent preference. Sources of Selection Driving Codon Preference Change across Codon Positions within Genes Given that there are relationships between preferred codon usage and tRNA availability and the position within genes, we next examined the relationship between these phenomena. For this, we measured the average relative tRNA-dependent and tRNA-independent preferences at each codon position within genes. At the beginning and ends of genes the mean tRNA-independent preference shows the same pattern as overall adaptive preference. For tRNA-dependent preference, at the beginning of genes, we see a rapid decline over the first ca. 20 codons, and then a steady increase that matches the pattern overall. However, at the ends of genes, we see a drastically different pattern in the tRNA-dependent preference, which steadily increases starting about 170 codons from the stop codon and continues to increase until the stop codon. This finding is consistent with the expectation that selection favors use of codons that increase translation rates at the end of genes to facilitate release from the ribosome. Thus, by dividing codon preference into tRNA dependent and tRNA-independent components, we can see distinct patterns of selection driving codon use away from neutrality, especially the fact that the ends of genes appear to show a particularly strong signature of selection driven by tRNA adaptation. Fig. 9. Patterns of average relative tRNA-dependent and tRNA-independent codon preference across codon positions within genes. The first two panels show patterns of tRNA-independent preference at the beginning and the ends of genes. The other... Discussion The AT-biased genome of the social amoeba D. discoideum, coupled with estimated patterns of mutation, and an absence of gBGC, has allowed us to define codon preference in evolutionary terms. It therefore can be described as a property of the genome that reflects the degree to which natural selection has favored the use of some codons, driving their frequency away from neutrality. For example, even though we see that the overall pattern of codon usage is strongly biased towards the use of the AT-richer codon alternatives, this does not mean that these codons are evolutionarily preferred since this bias is expected under neutrality. To identify when codons are used more or less frequently than the neutral expectation, we modeled the neutral expectation of codon frequencies at base composition equilibrium using patterns of SNP variation. A large majority of synonymous CUB can be explained solely by mutational biases toward AT accumulation in this genome. However, the remaining variation shows signatures of natural selection shaping synonymous codon usage in order to influence properties associated with transcription and translation. Therefore, we refer to this variation as adaptive codon preference to reflect the potential adaptive value of the pattern. In many analyses, codon preference is inferred solely based on comparison of codon use in highly versus lowly expressed genes. This mode of analysis comes with assumptions, such as the mutation and nonselective fixation processes are no different between gene classes. It can also be tautologous—lowly expressed genes are deemed less adapted when their CUB is not as skewed in the direction of the optimal codon set, even if for such genes selection may not be favoring “optimal” codon usage. Because codon preference appears stable across different classes of genes, differing primarily in the magnitude, not in overall pattern, we were able to examine whether the pattern of adaptive preferred codon use matches codon preference inferred from gene expression. This indicates that in the absence of a neutral expectation, an approach tied to an analysis of gene expression variation provides a reasonable estimate of adaptive codon preference. However, we find evidence that some of the shift in codon use in highly expressed genes appears to be shaped by selection that is specific to the context of high expression, rather than reflecting an overall selective advantage to the use of certain codons more broadly. At the extreme, this difference is manifested by an increased use of certain codons in highly expressed genes that are used less often than the neutral expectation across the genome overall. This finding suggests that some caution is therefore needed when basing inferences purely on the assumption that codon use in highly expressed genes entirely captures the evolutionarily relevant pattern of codon preference across the genome. The pattern of selection reflected in codon preference is consistent with roles in the optimization of protein translation. A large fraction of adaptive codon preference can be explained by the relative availability of isoaccepting tRNAs for the alternative codons within each amino acid. Codon preference also impacts translation through its effect on mRNA stability, which increases with the average preference of the codons within a gene. Stability increases mRNA steady-state levels and has been reported as an important mechanism of optimization of expression. Interestingly, the effect of the use of preferred codons on transcript stability is almost entirely due to the component of preference that is independent of the relative tRNA adaptiveness of the codons. Therefore, the connection between codon use and transcript stability provides a source of selection shaping codon preference that would not be apparent from an analysis focused solely on adaptation to the tRNA pool. Our analyses also allow more subtle effects of selection on codon usage to be detected. For example, we find that patterns of codon preference shift across codon positions in genes, generating an intragenic “codon landscape,” with preference lower toward the start codon and approaching the stop codon of genes. The pattern of reduced codon preference near the start and end of genes is consistent with reduced strength of selection or increased mutation, given that a reduction in codon preference corresponds to a shift in codon usage toward the neutral expectation. However, the reduction in frequency of preferred codons near gene boundaries appears to be adaptive. Shifts in the use of preferred codons are stronger among highly expressed genes, consistent with highly expressed genes being under stronger optimizing selection to counteract the influence of mutation. Furthermore, we see less synonymous polymorphism approaching the start codon and the stop codon across all genes, which also strongly suggests that those regions are experiencing elevated purifying selection, rather than relaxed selection or elevated mutation. These findings are thus consistent with the idea that shifts in codon use at the 5′ and 3′ ends of genes influences the temporal and spatial nature of interactions between mRNA transcripts with ribosomes. In the region near the start codon, selection for less optimal codons may slow down transcriptional elongation at the beginning of genes to increase accuracy and ensure more even spacing of protein synthesis at ribosomes, which reduces ribosomal “traffic jams”. The scale of this “ramp” may be dictated by the length of the exit tunnel of the ribosome, which is approximately the scale over which we see the pattern of codon preference shift near the start of CDSs. There is also evidence that codon use near the start codon may reflect selection for reduced mRNA folding, which facilitates initiation of translation. Although we do not have any estimates of the influence of codons on mRNA folding in our study, it is possible that this phenomenon is related to the influence of preferred codons on transcript stability, with both potentially reflecting binding properties of transcripts. Taken together, our findings suggest that adaptive preferred codon usage can be measured in D. discoideum as a deviation from the neutral pattern. This reveals that selection favoring evolutionarily preferred codons confers a selective advantage through the optimization of gene expression. We suggest that the term “codon preference” should be reserved for departures of codon usage from the neutral expectation caused by an active role of selection arising from differences in codon fitness. Materials and Methods Synonymous Codon Frequencies and GC Distribution across the Genome Relative synonymous codon frequencies were estimated from the reference genome downloaded from Ensembl and using the R package seqinR. Before computing this codon table, we excluded all non-protein-coding sequences, genes from the mitochondrial genome and from a duplication in chromosome 2, present only in the strain AX4. This censoring was necessary because the codon unity is meaningful only when translated into amino acids, and because genes in these other regions can evolve under different dynamics in comparison with the rest of the genome. GC content was computed in coding and noncoding regions of all six chromosomes of D. discoideum, in windows of 50 kb. In a first sliding-window analysis, windows were separated by step sizes of 1 kb in order to capture patterns of GC levels across chromosomes. In a second analysis, GC was computed in 50 kb windows without overlaps, to compare local GC content in coding and surrounding noncoding regions within each window. In both cases, we used coordinates from Ensembl Protist gene annotation release 46 to characterize chromosome regions as coding or noncoding DNA. We also used these coordinates to localize a list of genes annotated as TEs in Dictybase to test the hypothesis that peaks of elevated GC could be associated to the presence of such elements. Peaks of both lower and higher GC were identified from noncoding regions, under the assumption that noncoding DNA evolve close no neutrality. Per gene total GC and GC3 content for the coding regions of each gene, as well as the overall GC content of their corresponding intronic regions were also calculated based on gene and CDSs coordinates from Ensemb Protist. Per gene total GC, GC3, and intronic GC were then log 10 transformed. To reduce noise in the comparisons between these estimates for different classes, short genes, TEs, and genes showing conditional expression were excluded from these analyses. Nucleotide Substitution Matrix and GC eq Overall nucleotide composition is mostly a result of mutational biases, so understanding the evolution of such an AT-biased genome as in D. discoideum must include a detailed investigation of mutational processes. Because experimental work on mutational patterns in this system resulted in conclusions drawn from a single SNP, we used information from segregating variation to derive general patterns. This data set includes 67 natural strains, and details on the geographical distribution of the strains, sequencing reports, mapping, and SNP calling are provided elsewhere. Briefly, reads were cleaned for adapters and quality trimmed using Trimmomatic. Reads derived from possible contaminants were excluded by binning and simultaneously mapping them to the reference genome of D. discoideum, Paraburkholderia xenovorans lb400, Burkholderia ubonensis, Paraburkholderia fungorum, and Klebsiella pneumoniae ; and assigning them according to the best mapping score using BBSplit, part of the BBMap package. Reads binned with D. discoideum or not mapped to any of the bacterial genomes aforementioned were pooled together and mapped to the D. discoideum reference genome using NextGenMap. SNP calling was then performed using Genome Analysis Toolkit. Resulting SNPs were filtered with a static threshold for quality by depth < 2.0, an FS score > 60.0 and a root mean square mapping quality over all the reads at the site of < 30.0. Any strain with a missing call rate higher than 0.3, any site called in <90% of the remaining strains, and multiallelic site or indel were also removed. This resulted in a data set of 279,807 SNPs across 67 strains. In order to calculate an estimate of the expected GC under equilibrium, SNPs were filtered to include only those from noncoding regions, since these are expected to be mostly governed by mutation–drift balance. Directionality was inferred from polarization of rare alleles in comparison with the common alleles. Relative rates of mutation between different nucleotides were first calculated by scaling SNP counts to the number of sites and then rescaled again by dividing these per-site measures by their sum to get a relative rate. This information was used to generate the nucleotide substitution matrix with proportion of substitutions in all directions of mutational space, which in turn was used to derive the expected GC under equilibrium using Sueoka’s equation: GC eq = AT → GC AT → GC + GC → AT. This same analysis was carried out for a set restricted to SNPs in the introns of the 1,000 most highly expressed genes to generate a separate estimate of the mutation profile and GC eq for this category of genes. Again, intronic coordinates were based on the Ensembl Protist gene annotation release 46. The pattern of mutations per site calculated for all genes was used to generate an expected distribution for intronic mutations, which was normalized to account for a difference in the absolute level of polymorphism in the introns of highly expressed genes compared with all noncoding sites across the genome. For this analysis, we combined the equivalent mutational classes because SNPs cannot be assigned to strands. We then compared the observed number of mutations in each class within the introns of highly expressed genes to those expected based on the genome-wide mutational profile of noncoding sites using a chi-square test with five degrees of freedom. Estimation of Rates of Recombination To assess local variation in recombination rates and its relationship with local GC content, we estimated population-scaled recombination rates for our sample of strains along nonoverlapping sliding windows of 5 kb in length, covering the whole genome, using a machine-learning approach implemented in the FastEPRR R package. To estimate confidence intervals for ρ for each window, we ran 1,000 replicates, using default ρ values for simulating the training sets. Afterward, 1 × 10 −6 was added to the estimated value of ρ of each window, to allow for windows with an estimate of ρ = 0 to be included in subsequent analysis, and estimates of ρ where then log-transformed. We furthermore calculated the overall GC percentage, over the same genomic windows, using the Biostrings R package. We then measured the correlation between the log-transformed recombination rate estimates and the overall GC percentages in the genomic windows. This was done for all windows across the genome as well as separately for each chromosome. Expected Relative Frequencies and Identification of Preferred Synonymous Codons The estimated value of GC eq from equation was first used to calculate the expected absolute codon frequencies from the product of the expected frequencies of the component nucleotides. For example, the expected frequencies of the two codons for lysine are: E = E 3, and E = E 2 × E, where the individual nucleotide frequencies are those expected at GC eq. The expected frequency of the amino acid is, therefore, the sum of the absolute codon frequencies for all codons coding for that amino acid. For lysine, this would be as follows: E f Lys = E f AAA + E f AAG. The total expected frequency for each amino acid was then used to rescale the frequency of the codons within the amino acid to produce the relative frequencies of the codons. For example, the expected relative frequency of the AAA codon within lysine would be: E f ^ AAA = E f AAA E f Lys. The alternative method of estimating expected relative frequencies by computing the emergence of triplets under neutrality was performed as follows. Noncoding regions of all six chromosomes were concatenated in a single linear sequence, which was divided in triplets on the three frames. Absolute frequencies of these pseudocodons were calculated based on the sum of counts of each pseudocodon in all three frames. These frequencies were translated into relative frequencies following the methods above, treating the pseudocodons the same way we treated the real codons. To estimate the pattern of preference for different codons, we accounted for the expected frequency of codons driven by base composition bias by subtracting the relative synonymous codon frequencies expected at GC eq from the observed relative synonymous codon frequencies. This method assumes that codons used more often than predicted under neutrality must confer an advantage and are favored by selection. Conversely, codons used less frequently than expected by neutral evolution are assumed to confer a disadvantage and are therefore unpreferred/avoided. The resulting measure of codon preference can be interpreted as a log fold change from neutrality, which is assumed to be caused by selection. Association between Codon Preference and Segregating Synonymous Polymorphism To identify synonymous mutations, we used the Ensembl variant effect predictor to characterize the consequences of SNPs based on the EnsemblProtist gene annotation release 46. We tested our hypothesis about codon preference by examining the relationship between the properties of codons and the inferred fitness effects of different types of synonymous mutations. For this, we assume that signatures of selection on synonymous codon usage are captured in the levels of synonymous polymorphism. This is based on the assumption that codon preference imposes purifying selection, such that segregating polymorphism primarily represents deleterious mutational variation. To understand these relationships, we modeled the expected neutral distribution of synonymous polymorphism based on the pattern of mutation estimated from noncoding regions. The expected patterns of mutational variation was compared with naturally occurring patterns measured from a set of 67 genome sequences. We examined the correlation between the relative amount of synonymous polymorphism and the change in preference caused by the change in codon associated with each synonymous mutation. To calculate the expected frequency of each synonymous mutation, we then multiplied the genome-wide frequency of a given codon by the relative proportion of all mutations that are in that class of mutation. For example, consider a GCA to GCC change. The GCA codon has a frequency of 0.0164 and the change requires an A to C mutation, which represents a proportion of 0.01 of all mutations, making the raw proportion for this change p ij = f i m j = 0.0164 × 0.01. These raw values were normalized by dividing by their sum such that each value gives the proportion of all SNPs observed that are expected to be in that given class as follows: p ^ i j = f i m j ∑ f i m j = p i j ∑ p i j. These proportions are given in supplementary table S4, Supplementary Material online. Using the expected relative proportions of SNPs, we then tested whether the proportion of synonymous mutations within each codon is associated with the relative preference of those mutations. This approach controls for variation in the relative selective impact of synonymous mutations across different codons, essentially asking whether the probability of observing different types of synonymous changes from a given codon depends on the preference of the destination codon. For three classes of synonymous mutation, all being very rare codons for arginine, we found no synonymous SNPs. We replaced the zeros with a count of one to allow them to be included in this analysis, but this change makes no difference to the result. This analysis is necessarily restricted to codons for which there is more than a single class of synonymous mutation since it relies on there being alternative mutational “options.” Therefore, this analysis is restricted to 114 of the full set of 134 possible synonymous mutations. For each codon, the expected proportion of each of the possible synonymous mutations was calculated from the relative mutation rate. For example, for the GCA codon coding for alanine, there are three possible synonymous mutations resulting in the GCC, GCG, and GCT codons, respectively. The mutation rate for each of these classes of mutation are approximately 0.01, 0.04, and 0.04. Therefore, we expect to see the three types of synonymous mutations in the proportions about 0.11, 0.44, and 0.45. These expected proportions were then compared with the observed proportions by calculating the log 10 of the observed proportion divided by the expected, which provides a deviation measure that was calculated across all possible codons. For example, in the case of the GCA codon, we observed the three classes of synonymous mutations in the proportions 0.16, 0.43, and 0.41, resulting in log 10 frequency deviations of 0.17, −0.01, and −0.04. This result suggests an overabundance of mutations from GCA to GCC and a possible underabundance to GCG and GCT. To understand whether the deviations in mutation proportions per codon reflect selection arising from codon preference, we tested whether the relative preference of each codon predicts the relative abundance of that class of mutation. To be able to analyze patterns across all codons, we scaled the preference values of possible alternative codons by measuring them as deviations from the average preference of those particular codons. For example, in the case of mutations at the GCA codon for alanine, the three possible synonymous mutations have preference values of ca. 0.82, −1.62, and −0.41, with a mean of ca. −0.40. These raw preference values were scaled as deviations from the mean, giving them relative preference values of ca. 1.22, −1.21 and −0.01. Codon Use in Highly and Lowly Expressed Genes We used publicly available transcriptome data from vegetative and developmental cycles in D. discoideum to identify sets of highly and lowly expressed genes. Expression levels were defined as the average expression after normalization of vegetative and developmental RNAseq libraries. Details of the analysis are provided by de Oliveira et al. and only briefly outlined here. Libraries were normalized using the TMM method implemented in edgeR, after removing genes with low counts, following authors’ specifications. Very short and very long genes were removed from our analyses, and the two classes of top 1,000 highest and 1,000 lowest expressed genes were selected among nonconditionally expressed genes. This allows us to have a measure of expression that applies throughout the life cycle and removes the potentially complicating effects of conditionality. We then calculated the frequencies of codon use in each of these two sets of genes and used these frequencies to calculate the average levels of codon preference for each set. We also used the log 2 transformed relative frequencies to generate a measure of codon preference that is analogous to the one based on the deviation of observed relative frequencies from the neutral expectation. Parameters of Translational and Transcriptional Selection Coevolution of codons with the pool of isoaccepting tRNAs is likely to be an important process shaping codon usage. This coevolution hypothesis is often tested by estimating the relative codon adaptiveness, which gives a measure of fitness assigned to each codon. A limitation of this method is that w i is defined relatively to the maximum adaptiveness value across all codons, including codons for different amino acids. This means that it may not be an appropriate measure for understanding the usage of alternative codons, since different indices of tRNA adaptiveness may be due to differences in amino acid usage rather than differences on the strength of selection on synonymous codons to optimize expression. Therefore, to generate an index that is appropriate for the study of synonymous codons, we rescaled the measure of codon adaptiveness such that it measures the relative values for different synonymous codons for each individual amino acid. Thus, the relative synonymous codon adaptiveness of a particular codon is defined as follows: w i j = W i W j max, where W i is the absolute codon adaptiveness, and W j max is the maximum absolute adaptiveness among codons of amino acid j. This parameter was estimated by adapting R scripts from dos Reis et al, after removing codons for methionine, tryptophan and stop signal. Following dos Reis et al, we replaced the measure of w i with the geometric mean of all codons with a value of w i > 0 for the two codons, where w i ∼ 0, which prevents these very low values from driving patterns. To understand the extent to which codon preference is explained by coevolution with the tRNA pool or by other parameters, we partitioned the variation in codon preference in tRNA-dependent and tRNA-independent components. The tRNA-dependent component corresponds to the component of codon preference that can be predicted based on w ij, whereas the residual value of codon preference gives the tRNA-independent component of codon preference. As a measure of transcriptional selection, we estimated levels of transcript stability based on Gibbs free energy, using the RNAfold tool from ViennaRNA package. Given the same transcript length, transcripts with lower Δ G 0 are more stable. Because transcript length can also influence stability levels, we weighted the original parameter by CDS length to obtain an estimate per site. Modelling Codon Use across Codon Positions within Genes To understand whether the overall model of codon use varies across genes, we used a data set filtered for gene length and calculated the frequency of each possible codon across all genes at each codon position within the genes in both the 5′ to 3′ and the 3′ to 5′ directions. To avoid overlap between the analysis from the 5′ to 3′ and in the 3′ to 5′ directions, we restricted our analysis to the first or last 250 codon positions. The position-specific table of codon frequencies was used to calculate the average preference of codons by simply multiplying the vector of frequencies of the codons at each position and the vectors of codon preference. Codon Use in Conditionally Expressed Genes Conditionality of the social cycle has been shown to have an important impact on evolution of the genes expressed only in the social cycle because it dilutes selection, resulting in the Red King process. Therefore, we contrasted patterns of codon use in conditionally expressed “sociality” genes with the “nonsociality” genes as defined in de Oliveira et al. by comparing the means of average preference in the two groups, after removing genes <500 bp. Supplementary Material Supplementary data are available at Molecular Biology and Evolution online. Supplementary Material msab099_Supplementary_Data Click here for additional data file. 