 Many signaling systems execute adaptation under circumstances that require noise attenuation. Here, we identify an intrinsic trade-off existing between sensitivity and noise attenuation in the three-node networks. We demonstrate that, although fine-tuning timescales in three-node adaptive networks can partially mediate this trade-off in this context, it prolongs adaptation time and imposes unrealistic parameter constraints. By contrast, four-node networks can effectively decouple adaptation and noise attenuation to achieve dual function without a trade-off, provided that these functions are executed sequentially. We illustrate ideas in seven biological examples, including Dictyostelium discoideum chemotaxis and p53 signaling network, and find that adaptive networks are often associated with a noise attenuation module. Our approach may be applicable to finding network design principles for other dual and multiple functions. In brief Minimizing the trade-off between sensitivity and noise attenuation dictates the design principle for the dual function of adaptation and noise attenuation. Introduction A fundamental challenge in biology is to understand how the signaling systems in living organisms are able to accurately respond to the external signals and robustly carry out their functions. General design principles have been found to link recurrent network motifs to specific biological functions, such as reliable cell decisions, robust biological oscillations, faithful noise resistance, optimal fold-change detection, cell polarization and adaptation. The function of adaptation, referring to the system’s ability to react to a change of signal and return to the pre-stimulated level, is vital for living systems to sense a wide range of change. Such response terminates the signal response after an appropriate time and resists the changed environment to maintain their own stability. For example, bacteria maintain their sensitivity to chemical gradients over a wide range of attractant or repellent concentrations. Adaptive Msn2 localization pulse under oxidative stress induced by H 2 O 2 plays an important role for yeast to survive environmental challenges. Besides, adaptation of E mediated by miR-7 through an incoherent feed-forward loop helps to drive the final state to the previous value after the upstream signal changes dramatically, which stabilizes the developmental process of drosophila. Adaptive behavior can be measured collectively by two quantities: sensitivity and precision. Sensitivity describes how large the magnitude of the relative output response is whereas precision depicts how close the pre- and poststimulus steady states are. An exhausted search on all possible three-node enzyme networks shows that the adaptation can be achieved by networks containing at least one of two core motifs: a negative feedback loop with a buffering node and an incoherent feedforward loop with a proportioner node. Similarly, negative feedback loops and incoherent feedforward loops are also core motifs in three-node adaptive gene regulation networks. Figure 1. Searching for circuits capable of adaptation and noise attenuation. Signaling systems also need to resist noise to enable reliable responses. It has been found that feedback loops play important roles in noise attenuation. For instance, negative feedback typically reduces cell-cell variations. On the other hand, positive feedback can attenuate noise better than NF while the sensitivity is maintained. By counting on timescales of feedback loops, linking fast and slow positive feedback loops is able to maintain a high state and resist large noise. Moreover, the signed activation time, which describes the difference between deactivation and activation time, is a key feature that measures the ability of noise reduction in a regulatory system. Since adaptive systems are often operated in noisy circumstances, how to achieve noise attenuation and adaptation simultaneously is clearly a challenging task. In equilibrium systems in which the detailed balance condition is satisfied, reducing noise and maintaining high sensitivity cannot be achieved simultaneously based on the fluctuation dissipation theorem. However, most sensory and regulatory systems are non-equilibrium; external metabolic energy is consumed to drive the dynamics of the system. It has been demonstrated that it is possible for a system to have both high sensitivity and low fluctuation. In terms of network topologies, the investigation of intrinsic noise and adaptive response shows that negative feedback loop has a higher response magnitude than incoherent feedforward loop for a given intrinsic noise level. Moreover, timescale plays a critical role of noise attenuation in adaptive systems. Adaptive systems may behave as a bandpass filter so that high-frequency extrinsic noise can be averaged out through response time while low-frequency extrinsic noise can be filtered by adaptation time. Instead of exploring adaptation properties and noise resistance in some classic adaptive networks or experimentally observed networks, we ask the design principle of low noise and perfect adaptation from the bottom-up. What kind of network topologies can maintain adaptation and reduce noise simultaneously? If such networks exist, what are the underlying design principles? Here, we systematically investigate the design principles that link network topologies to dual function in both three- and four-node networks. We first use three-node networks as a minimal framework and enumerate all possible network topologies to reveal the trade-off between sensitivity and noise attenuation capability. In order to mediate such trade-off, we also tune the timescale of nodes in three-node adaptive networks. This strategy can result in better dual function but introduces some “costs”. Then we turn our attention to four-node networks, whose flexibility may provide ways to achieve dual function and overcome the limitations of three-node networks. We sequentially combine noise attenuation modules with adaptive modules in four-node networks to investigate how different strategies influence the compatibility for dual function. Our analysis suggests that despite the simplicity of the modules for single function, achieving multiple functions simultaneously requires that different functional modules work coherently in both time scales and topologies. We further explore a larger four-node network space with an evolution algorithm and the design principle of sequential combination emerges again. Examination on seven biological systems shows that adaptive networks are often sequentially coupled with a noise attenuation module. Results Sensitivity, precision, and noise amplification rate We aim to explore the design principle for network executing both adaptation and noise attenuation. The adaptation behavior and noise propagation process are captured by three quantities. The adaptation behavior can be described by two quantities: sensitivity and precision. Sensitivity and precision are defined as follows: S e n s i t i v i t y = | / O 1 / I 1 |, and P r e c i s i o n = | / O 1 / I 1 | − 1, where O 1 and O 2 are output values in steady state under the input signal I 1 and I 2 respectively, and O peak is the transient peak value when the input signal changes from I 1 to I 2. Sensitivity describes the size of the output jump while the precision represents how close the pre- and poststimulus output levels are after a persistent change of input signal. The system noise level in the output is described using the standard Noise Amplification Rate : N A R = s t d / m e a n s t d / m e a n, where I denotes the input signal fluctuating around I 1 or I 2 and O is the corresponding output level in steady state. Thus, according to definition of three quantities, networks capable of dual function should have large sensitivity, high precision and low NAR. We use enzymatic regulatory networks and Michaelis-Menten rate equations to model both three-node and four-node networks. An enzymatic regulatory network with IFFLP topology is illustrated in Figure 1D as an example. Enzyme A is activated by input and active enzyme A activates both enzyme B and C. In contrast to enzyme A, active enzyme B can deactivate enzyme C, thus forming an incoherent feedforward loop. Since both node A and node B have only positive incoming links, basal deactivating enzymes are added to regulate the two nodes. With the assumption that the total concentration of each enzyme is a constant, the network is modeled as ordinary differential equation with three variables. Each variable represents the concentration of active enzyme and f i is the reaction rate of active enzyme. Each term in f i takes the form of Michaelis-Menten equation with Michaelis-Menten constant K and catalytic rate constant k. Any three- or four-node network follows the same way to construct the model. Given all the values of k IA, K IA, k F A A, ⋯, sensitivity and precision are calculated through the dynamics of enzyme C when input changes from I 1 to I 2, and NAR is derived by linear noise approximation when input fluctuates around I ss with autocorrelation time τ 0. There exists an intrinsic trade-off between robust adaptation and noise attenuation in three-node networks We first try to answer whether three-node networks can robustly execute adaptation and buffer noise simultaneously. For each network topology, we measure its robustness by using the Q value, which is defined by the number of parameter sets that can yield the target functions. To be more precise, we sample 10,000 parameter sets for each topology and quantify three Q values: Q A for adaptation, Q N for noise attenuation, and Q A&N, for dual function. Here, adaptation is defined by sensitivity>1 and precision>10, and noise attenuation is defined by NAR<0.2. Dual function of adaptation and noise attenuation is achieved if sensitivity>1, precision>10 and NAR<0.2 are satisfied simultaneously. In our simulation, the initial input increases by 12.5%. If the output first changes more than 12.5% and finally goes to its steady state that is less than 1.25% different from the initial state, sensitivity is larger than 1 and precision is larger than 10. If NAR<0.2, the normalized standard deviation of output is smaller than one-fifth of that of input. There are total 16,038 possible three-node network topologies, and only 395 networks have been found as the robust adaptation networks. However, since finite sampling of parameters may lead to some randomness in Q values and the threshold Q=10 for defining adaptive network can be somewhat arbitrary, to avoid missing some other possible adaptation networks, we enumerate all three-node networks rather than taking directly the 395 adaptation networks found previously to investigate the dual function. Enumeration of all possible 16,038 three-node network topologies shows that none of them leads to robust dual function. Figure 2A shows the Q A – Q N − Q A & N space of 16,038 three-node network topologies. Among all these network topologies, 4.65% can achieve non-zero Q A and 96.97% non-zero Q N. However, there is no parameter set that can meet the criterion of dual function for all 16,038 networks. Although there are nonzero Q A & N for several network topologies when the sample size of parameter sets increases to 10 6, the maximal Q A & N is less than 10. These results indicate that some network topologies may have good performance of individual function but are still difficult to achieve dual function. For example, circuits buffering noise always show little response to external stimuli while adaptive circuits with high sensitivity usually accompany with large noise. Figure 2. The trade-off between robust adaptation and noise attenuation in three-node networks. To dissect the difficulty of achieving dual function, we investigate the interdependencies among three quantities. Pearson’s correlation coefficients are calculated to measure correlations among three quantities for all 16038 network topologies. It can be seen that sensitivity is highly positively correlated with NAR, with Pearson’s correlation coefficients ranging from 0.8 to 1. This means that larger sensitivity generally results in higher NAR, which implies a trade-off between adaptation and noise attenuation, hindering the achievement of dual function. In contrast to sensitivity, precision is negatively correlated with NAR, which benefits dual function. It should be noted that adaptation alone requires to overcome the negative correlation between sensitivity and precision, which results in an IFFLP or NFBLB architecture in three-node adaptive networks. Additionally, a similar analysis in three-node transcriptional regulatory networks further confirms the trade-off between adaptation and noise attenuation. Fine-tuning timescales in three-node networks can partially mediate the trade-off between sensitivity and NAR with a cost In order to minimize the trade-off between sensitivity and NAR, we analyze the effect of timescales on these two quantities. We use IFFLP as an example to illustrate how timescale modification is performed. First, for the three-node network modeled by d A d t = f A, d B d t = f B, and d C d t = f C, we choose one set of parameters capable of good precision. Then with all of the parameters in f A, f B and f C fixed, we introduce three parameters, τ A, τ B and τ C to simulate a new system τ A d A d t = f A, τ B d B d t = f B and τ C d C d t = f C, where tuning τ A, τ B or τ C can change the timescale of the corresponding node. Since changing τ A, τ B or τ C has no influence on precision, we can investigate how timescales affect sensitivity and NAR. For IFFLP, when τ A is fixed as a constant, smaller ratio of τ C to τ B > results in higher sensitivity. With fixed ratio of τ C to τ B, larger τ C leads to smaller NAR but has little effect in sensitivity. Similar results can be obtained for NFBLB. The reason for smaller ratio of τ C to τ B leading to higher sensitivity can be given in this way: small ratio of τ C to τ B causes a steep slope of the node C trajectory at the initial response when the input intensity changes from I 1 to I 2, and therefore the maximum of node C in the phase plane becomes large. This can be further validated by mathematical analysis. With fixed ratio of τ C to τ B, analytical derivation of NAR using linear noise approximation shows that NAR is a decreasing function of τ C when τ C is large enough compared to the autocorrelation time of input noise. In fact, with more general form of rate equations, IFFLP and NFBLB still obey the same monotonicity of sensitivity and NAR as functions of τ B and τ C. Taken together, one feasible strategy for reducing the trade-off in IFFLP or NFBLB is to increase τ C for small NAR while decreasing the ratio of τ C to τ B to ensure high sensitivity. For instance, when we fix a small ratio τ C / τ B and increase τ C to ten times, noise can be greatly reduced while sensitivity is almost unchanged. However, the cost to improve dual function by adjusting timescales is a large increase of the adaptation time τ AD that is defined as the time required for the output to return to halfway between the peak value and the steady-state value after change of the input. 2L ). That is to say, to obtain a small NAR while maintaining adaptation, the system is required to take a long adaptation time, which depends on the timescale of input noise and network topology. If the time scale of the input noise is faster, the adaptation time required to reach a certain level of NAR will be shorter for both IFFLP and NFBLB. Sampling within the same parameter space, NFBLB tends to have shorter adaptation time while IFFLP can reach smaller NAR. Overall, there is a trade-off between NAR and adaptation time. In fact, for all adaptive three-node networks, the trade-off between sensitivity and NAR can be partially lifted by fine-tuning the timescales of node B and node C to obtain both high sensitivity and low NAR. However, besides the side effect of increasing the adaptation time, changing the timescales is equivalent to expanding the search space of kinetic parameters, which may be out of biologically realistic range. Combinations of function-specific modules in four-node networks can achieve dual function Since dual function in three-node networks is difficult to obtain, we next study four-node networks as more nodes often provide more flexibility in controlling functions. If we just consider networks that contain at least one direct or indirect causal link from the input node to the output node and exclude redundant networks that are topologically equivalent, the number of possible four-node networks is 19,805,472, which is about 1,200 times more than that of possible three-node networks. Besides, compared to three-node networks, the number of parameters in a four-node network is typically larger, leading to an exponentially increase in the volume of the parameter space to be sampled. Thus, enumeration with effective parameter sampling of all four-node networks is computationally too expensive. Alternatively, we construct four-node networks by assembling two function-specific modules: adaptation module and noise attenuation module. A straightforward strategy is the sequential connection of these two modules, including N-A types and A-N types, where N represents noise attenuation and A represents adaptation. N-A types indicate that the input signal passes through an upstream noise attenuation module and then the downstream adaptation module, while A-N types require that the adaptation module is placed upstream of the noise attenuation module. We choose IFFLP and NFBLB as adaptation modules while PF and NF as noise attenuation modules. Thus, by combining minimal adaptation modules and noise attenuation modules, we obtain eight four-node networks including four N-A types and four A-N types. These networks do not have redundant links and thus may constitute minimal four-node networks capable of dual function. Since we allow the input node and the output node to be the same for these modules, IFFLP and NFBLB can be reduced to two-node adaptive networks in Figure 3B. Figure 3. Dual function can be achieved by module combination in four-node networks. We explore the capability of these A-N and N-A networks to achieve dual function. As an illustration, the Q value of PF-IFFLP type is computed as follows. First, we randomly assign 2 × 10 6 parameter sets for PF and IFFLP, respectively. For IFFLP, circuits capable of adaptation are recorded and we use a to denote the number of these adaptive circuits. For PF, circuits capable of noise attenuation are selected out and its number is denoted by n. Here, the criterion for an adaptation circuit is sensitivity>1 & precision>10 while the criterion for a noise attenuation circuit is modified as sensitivity>1 & NAR<0.2. The reason why sensitivity>1 is added to the criterion for noise attenuation is that we expect to maintain the system’s sensitivity when the signal is passing through the noise attenuation module. Because of the extremely low percentage of functional NF circuits, we increase the number of sampling parameter sets to 2 × 10 6. Then, we assemble function-specific circuits to construct a × n and characterize corresponding dynamic behaviors to calculate the Q value. We first compute the Q values for the eight networks listed in Figure 3B under different thresholds of sensitivity and NAR. For each bar graph, the criterion for dual function is determined by the x coordinate and y coordinate: sensitivity>x & NAR<y & precision>10. We define Q ¯ as the averaged Q value calculated by eight repeated simulations and it is modified by adding 10 −8 to ensure log is well-defined. Green bars denote four N-A networks: PF-IFFLP, NF-IFFLP, PF-NFBLB, NF-NFBLB while red bars denote four AN networks: IFFLP-PF, IFFLP-NF, NFBLB-PF, NFBLB-NF. The results show that combinations of function-specific modules in four-node networks can lead to dual function. With sensitivity>1 & NAR<0.2 & precision>10 as the criterion, seven of the eight four-node network topologies can achieve non-zero Q values. Although stricter criteria result in smaller Q values, the Q value rankings of the eight networks are almost consistent under different combinations of thresholds of sensitivity and NAR. Moreover, most N-A networks perform better than A-N networks with the same adaptation and noise attenuation modules except for the combination of PF and NFBLB, and networks with IFFLP have higher Q values than those with NFBLB. Next, we investigate which factors affect Q values of assembled four-node networks. Clearly, the robustness of each component module, i.e., the number of adaptive circuits a or the number of noise attenuation circuits n can affect Q values since the network topology with larger a or n has the greater potential to generate more parameter sets capable of dual function. With sufficient simulations, we find that adaption modules NFBLB and IFFLP do not share a same value of a, neither do noise attenuation modules PF and NF. Furthermore, n of PF is about fifty times larger than that of NF, while a of NFBLB is roughly double that of IFFLP. A closer look at the robustness of four modules is shown in Figures 3D – 3G. Joint distributions of sensitivity and NAR for noise attenuation modules show that PF has a broader and denser functional region than NF, implying a larger n. 3E ). For adaptation modules, the functional region of NFBLB is larger than IFFLP, indicating a larger a for NFBLB. However, more robust component modules cannot guarantee to constitute better dual function. For instance, PF-IFFLP performs better dual function than PF-NFBLB despite that NFBLB module can achieve more robust adaptation than IFFLP module. Thus, we define the compatibility as the probability of successful combination of adaptation modules and noise attenuation modules, i.e., C o m p a t i b i l i t y = Q a × n. We use this quantity to measure the level of compatibility of the two modules when combined sequentially to perform the dual function. Given the same adaptation and noise attenuation modules, N-A networks have better compatibilities thus better performance than A-N networks, except PF-NFBLB. For N-A networks, topologies with NF in the upstream have better compatibilities than those with PF when the downstream module is fixed, and IFFLP in the downstream leads to better compatibility than NFBLB. The A-N networks obey similar rules, where IFFLP-NF is more compatible than others. The response time of upstream module is a key factor for dual function To identify the key factor that determines the compatibility between modules, we investigate how sensitivity, precision and NAR are affected in the eight assembled four-node networks. The lower panel in Figure 3H shows the percentages of parameter sets in the eight networks that meet the requirement of sensitivity, precision and NAR for dual function. It can be seen that less than 10 percent of parameter sets can satisfy sensitivity>1 for all eight networks except NF-IFFLP. Instead, percentages of parameter sets for good precision and NAR are relatively high. Thus, loss of sensitivity after module combination can be the bottleneck to achieve dual function. Furthermore, the order of N-A networks sorted by percentages of sensitivity>1 is consistent with that sorted by compatibility, indicating the impact of sensitivity on the compatibility. Since the downstream module receives the output of the upstream module, the output dynamics of the upstream module plays a role in the downstream output sensitivity. Two quantities can be used to collectively characterize the upstream output dynamics: sensitivity and response time. However, we pay particular attention to the upstream response time, because the upstream circuits with different topologies have been limited to those with the same requirement of sensitivity but with no restriction in response time. Thus, in what follows, we investigate how the upstream response time affects the downstream output sensitivity and its dependence on network topology. First, we focus on N-A networks. As the noise attenuation module, PF tends to have longer response time than NF. Such difference of response time between PF and NF may cause divergence in the output sensitivity of PF-A and NF-A. To test this hypothesis, we construct a series of dynamics to imitate the outputs of the upstream noise attenuation module where response time and sensitivity of the upstream outputs can be assigned manually. The general form of the dynamics is defined as following: O u p = and the combination of signs of these two links can be,, or. Thus, there are total 3×3×4=36 different realizations of the two additional links when added to a three-node minimal adaptive network. By this method we construct two subsets of networks in the whole four-node network space, i.e., the IFFLP-based subset and the NFBLB-based subset, each of which has 36 different four-node networks. Note that these sets include N-A networks and A-N networks. To find the network topologies in these subsets that best perform the dual function, we employ an evolution algorithm. For each subset, the algorithm begins with an initial collection of circuits whose topologies are randomly chosen from the subset and parameters randomly assigned. Through many rounds of growth and selection, the circuit collection evolves towards higher performance of the dual function. For the IFFLP-based subset, we obtain 115 circuits capable of dual function from 400 implementations of the evolution algorithm. Six network topologies emerge with relatively high occurrences among the 115 functional circuits. Two of the six networks are N-A networks, in which added links A→D —| A and A —| D —| A form one negative and one positive feedback loop, respectively. This is consistent with fact that NA networks have advantage over A-N networks found previously. Interestingly, some new dual function four-node networks emerge. The network with the highest frequency of occurrence has added links C —| D —| B, forming a coherent feedforward loop from node A to node B. The #3 ranking network with added links A —| D —| B also has a coherent feedforward loop from node A to node B. For these two networks, the additional coherent feedforward loop is analogous to coherent type 4, which delays the activation of node B and thus may enhance the transient response of node C. Comparisons between these two networks and IFFLP show that the additional links C —| D —| B or A —| D —| B benefit high sensitivity with little effect on noise buffering capability. Moreover, IFFLP added with C —| D —| B or A —| D —| B can achieve higher sensitivity than IFFLP given the same level of NAR, which essentially results from slow response of node B caused by the additional coherent feedforward loop. For the other two networks with added links B —| D→A and B→D —| A, the additional negative feedback loop through node A coupled with IFFLP results in smaller adaptation error. For the NFBLB-based subset, only 18 circuits capable of dual function are obtained from 400 implementations. This is consistent with the previous conclusion that N-A and A-N networks containing NFBLB show worse performance of dual function than those containing IFFLP. The 18 circuits correspond to only three topologies. Similar to the IFFLP-based subset, two of the three topologies have an additional coherent feedforward loop from node A to node B, which may achieve high sensitivity by delaying the response of node B. The third topology has links B — | D —| B, a positive feedback loop which also slows down the activation of node B and thus enhances sensitivity. As expected, simulation results show that all of the three topologies improve sensitivity without compromising noise buffering capability compared with NFBLB. Further investigations on node B validate that the additional loop indeed slows down the response of node B to improve dual function in these three topologies. We also investigate the robustness of dual function for the IFFLP- and NFBLB-based subset, and find that top-ranked topologies obtained by the evolution algorithm also have higher robustness. To avoid zero Q values for almost all topologies, we calculate Q values using a relaxed criterion for dual function, i.e., sensitivity>0.8 & precision>10 & NAR<0.3. For the IFFLP-based subset, the #1 and #3 ranking topologies obtained by the evolution algorithm have the top 2 Q values and the N-A network with added links A—|D—|A has the 7 th highest Q value. Moreover, different thresholds of sensitivity and NAR have little effect on the Q value rankings of 36 IFFLP-based topologies. For the NFBLB-based subset, the three topologies with highest Q values are exactly those obtained by the evolution algorithm. The design principles for dual function revealed by exploring a larger four-node network space are consistent with those found in previous sections. The first thing is that N-A networks still show relatively high performance of dual function even within a larger network space. Second, besides the sequential connection of two modules, all the new topologies emerged achieve more robust dual function by a better performance in adaptation function, in particular by enhancing the sensitivity. This is consistent with our finding that maintaining sensitivity while reducing noise is the key for the dual function. This can be accomplished either directly by the sequential connection of two modules or indirectly by ways of enhancing sensitivity. Biological examples In previous sections, we have used three- and four-node networks as coarse-grained approximation to biological networks. Although the vast majority of biological networks are more complex and tend to have more than three or four nodes, many of them are likely to be abstracted into simpler networks with proper coarse-graining. Also, despite the apparent complexity, the underlying core network topology responsible for robustly executing the biological function might be simpler. Thus, the principles obtained from the simple three- or four-node networks may also help to understand more complex biological systems. By examining several adaptation networks in literatures, we found that the positive or negative feedback loop is often coupled with the adaptation module. For example, in Dictyostelium discoideum, under the change of ligand cAMP, Gβγ subunit on the membrane is activated and then modulates RasGEF along with RasGAP. RasGEF activates Ras, whereas RasGAP inactivates Ras. So Gβγ, RasGEF, RasGAP and Ras constitute an adaptation module. Meanwhile, PIP3, a vital intermediate molecular in the downstream of Ras, is involved in a positive feedback loop composed of PI3K, PIP3, RacGEF, Rac and F-actin. Since positive feedback is a noise attenuation module, co-occurrence of these two kinds of signaling pathways can be roughly regarded as an A-N network. Here, we use Dictyostelium discoideum chemotaxis network and p53 activation as biological examples to study whether these modularized signaling pathways can perform robust dual function. Figure 4. Examples of biological systems capable of dual function Dictyostelium discoideum chemotaxis Chemotaxis describes the directional movement of biological system when exposed to a chemical gradient. This behavior is crucial for organisms to seek for food, chase a signaling cue or avoid harmful environment, and is observed in many organisms such as bacteria, amoebae, neutrophils and tumor cells. In chemotaxis systems like bacteria and amoebae, perfect adaptation to changes in chemoattractant is essential to gradient sensing. At the same time, these systems face with diverse kinds of noise such as receptor-ligand binding noise, chemoattractant fluctuations and intrinsic noise. In Escherichia coli and Dictyostelium discoideum chemotaxis system, adaptation is driven by hydrolysis of SAM, ATP or GTP, which makes the system far from equilibrium and the detailed balance condition broken. Therefore, it is feasible for bacteria and amoebae to buffer noise while responding and adapting to signal change. The signaling pathways of Dictyostelium discoideum chemotaxis have been well studied. The whole regulatory network can be regarded as a IFFLP-PF type network. Signaling from the ligand to Ras constitutes the adaptation module. The ligand binds to the G-protein coupled receptor, activating the GPCR. Upon activation of GPCR, the heterotrimeric G-protein dissociates into a Gα subunit and a free Gβγ subunit. The free Gβγ subunit activates both RasGEF and RasGAP. RasGEF catalyzes GDP-bound Ras to GTP-bound Ras, while RasGAP converts active Ras to its inactive form by catalyzing GTP hydrolysis. Hence, the regulations of Ras form an incoherent feedforward loop, which is the core of the adaptation module. Downstream of the adaptation module is the noise attenuation module, characterized by the positive feedback loop between PI3K and PIP3. Accumulation of upstream output Ras activates PI3K on the plasma membrane. Active membrane PI3K phosphorylates the membrane lipid PIP2 into PIP3, a second messenger. Accumulation of PIP3 activates Rac by stimulating the activity of RacGEF, and activation of Rac leads to polymerization of F-actin. F-actin polymerization promotes the localization of PI3K on the plasma membrane from cytoplasm. Thus, PIP3 can facilitate the membrane localization of PI3K through F-actin polymerization and forms a positive feedback loop with PI3K. By merging the multi-steps in the linear pathway of regulation from PIP3 to PI3K into one step, this system can be simplified to seven species and modeled by following equations: d G β γ d t = k 1 ⋅ c A M P ⋅ − k d 1 ⋅ G β γ d R a s G E F d t = k 2 ⋅ G β γ − k d 2 ⋅ R a s G E F d R a s G A P d t = k 3 ⋅ G β γ − k d 3 ⋅ R a s G A P d R a s d t = k 4 ⋅ R a s G E F ⋅ − k d 4 ⋅ R a s G A P ⋅ R a s d P I 3 K d t = k 5 ⋅ R a s ⋅ P I 3 K m − k d 5 ⋅ P I 3 K d P I 3 K m d t = k 7 ⋅ ⋅ − k d 7 ⋅ P I 3 K m − k 5 ⋅ R a s ⋅ P I 3 K m + k d 5 ⋅ P I 3 K d P I P 3 d t = k 6 ⋅ P I 3 K ⋅ P 0 − P I P 3 P 0 − P I P 3 + K 6 − k d 6 ⋅ P I P 3. To investigate the importance of noise attenuation module, we destroy positive feedback by artificially deleting the regulation from PIP3 to PI3K as comparison. This is achieved by replacing PIP3 with a constant 0.44 in the equation of PI3K m. Parameters of upstream adaptation module are selected to achieve an adaptive response of Ras. Parameters of downstream module with or without positive feedback are randomly chosen with a sample size of 10 6. The adaptation precision of PIP3 is well maintained because of the good precision of Ras. The distributions of sensitivity and NAR without and with positive feedback are shown in Figures 4B and ​ and4C, 4C, respectively. The area bounded by red dashed line is the region of dual function, within which the network with positive feedback has a higher Q value than that without. Moreover, the superiority of the network with positive feedback in the Q value remains consistent for different combinations of thresholds of sensitivity and NAR. It demonstrates the critical role of positive feedback as a downstream noise attenuation module in the IFFLP-PF network of Dictyostelium discoideum chemotaxis to achieve dual function. p53 activation In mammalian cells, tumor suppressor p53 is a common mediator of many stress-related signaling pathways and plays a role in cell cycle arrest, senescence and apoptosis. However, different kinds of stresses can induce distinct temporal dynamics of p53, which may encode different information. For example, double-strand breaks caused by γ-radiation can lead to stereotyped pulses of p53, while single-stranded DNA damage caused by UV light can induce a dose-dependent adaptive dynamics of p53. The signaling pathway involved in response to UV can be regard as a PF-NFBLB type network. Exposure to UV light can cross-link adjacent cytosine or thymine bases and create pyrimidine dimers, leading to ssDNA damage. ssDNA damage lesions lead to recruitment of ATR and phosphorylation of ATR itself. Then the kinase activity of ATR is stimulated by TopBP1 with the help of other regulators such as Rad17 and 9-1-1 complexes. Once stimulated, ATR phosphorylates Chk1 and activation of ATR-Chk1 checkpoint pathway further increases the accumulation of TopBP1 to the DNA damage lesions, thus creating a positive feedback loop between ATR and TopBP1. Phosphorylation of p53 by Chk1 can activate p53 for DNA-binding, which enhances the expression of the target genes such as those related to DNA-repair processes, cell-cycle arrest, and apoptosis. The function of p53 can be controlled by two negative regulators, Mdm2 and Wip1, both of which are also target genes of p53. Mdm2 is a ubiquitin E3 ligase and can induce p53 degradation through the ubiquitin-proteasome pathway, while Wip1 is a phosphatase that can dephosphorylate p53 and thus reduce the activity of p53. So, in this network, ATR-Chk1-TopBP1-ATR forms the positive feedback loop, while Mdm2 and Wip1 act as the negative regulators of p53 and thus form two negative feedback loops with p53. Dynamics of the signaling network can be modeled by following equations: d A T R d t = k 1 ⋅ U V ⋅ ⋅ − k d 1 ⋅ A T R d T o p B P 1 d t = k 2 ⋅ C h k 1 ⋅ − k d 2 ⋅ T o p B P 1 d C h k 1 d t = k 3 ⋅ A T R ⋅ C h k 1 0 − C h k 1 K 3 + C h k 1 0 − C h k 1 − k d 3 ⋅ C h k 1 K d 3 + C h k 1 d p 53 i n a c t i v e d t = k g 4 − k d 4 ⋅ p 53 i n a c t i v e + k 4 ⋅ W i p 1 ⋅ p 53 a c t i v e K 4 + p 53 a c t i v e − k 5 ⋅ C h k 1 ⋅ p 53 i n a c t i v e K 5 + p 53 i n a c t i v e d p 53 a c t i v e d t = k 5 ⋅ C h k 1 ⋅ p 53 i n a c t i v e K 5 + p 53 i n a c t i v e − k 4 ⋅ W i p 1 ⋅ p 53 a c t i v e K 4 + p 53 a c t i v e − k d 5 ⋅ M d m 2 ⋅ p 53 a c t i v e K d 5 + p 53 a c t i v e d M d m 2 d t = k 6 ⋅ p 53 a c t i v e K 6 + p 53 a c t i v e − k d 6 ⋅ M d m 2 K d 6 + M d m 2 d W i p 1 d t = k 7 ⋅ p 53 a c t i v e K 7 + p 53 a c t i v e − k d 7 ⋅ W i p 1 K d 7 + W i p 1. Using this p53 model, we perform the same simulations as the chemotaxis model. Positive feedback can be eliminated the by replacing TopBP1 with a constant 0.5 in the equation of ATR and other parameters are shown in Table S4. We find that the positive feedback loop as the upstream noise attenuation module can increase the parameter region for dual function, indicating that such PF-NFBLB network for p53 dynamic is able to perform robust dual function. Discussion A longstanding question in biology is how complex biological networks in the cell perform sophisticated regulatory functions with a remarkable degree of accuracy, reliability, and robustness. Do “universal” design principles underlie cellular systems? Rather than searching for naturally occurring circuits on a case-by-case basis, one strategy is to understand the design logic from the bottom-up to achieve single or multiple functions. Here we have investigated both three- and four-node networks to search for the design principle for the dual function of adaptation and noise attenuation. An intrinsic trade-off was found to exist in three-node networks between system sensitivity, which is required in adaptation, and noise attenuation. Although fine-tuning timescales in three-node adaptive networks can partially mediate such trade-off, it introduces prolonged adaptation time and additional parameter constraints. Our results show that the required adaptation time to reduce noise can be unrealistically long. For example, to achieve a noise reduction of NAR=0.1, the adaptation time has to be about 10,000 times longer than the autocorrelation time of the input noise. A too slow adaptation time can be harmful for detecting rapid changes of signal, leading to a further tradeoff between noise buffering capability and signal tracking ability. In four-node networks, the dual function can be achieved robustly. The key challenge of maintaining system sensitivity while reducing noise can be met, via sequential combination of two sub-function modules. By evaluating effects of response times in noise attenuation and adaptation modules on the functional performance, we found that the combination of slow adaptation module and fast noise attenuation module can achieve better dual function. Our work highlights the importance of time scales in the relationship between topology and function. In some cases, timescale can be a key factor linking topology to function. For adaptation alone, the determining factor is topology. On the other hand, noise attenuation is closely related to timescale. Many works have shown how output noise depends on kinetic parameters such as degradation rate. Since different topologies can have distinct timescales, topology can therefore play a crucial role in noise resistance. For example, compared with NF, PF slows down the dynamics and therefore enhances noise buffering for a given steady susceptibility or transient sensitivity. 3E ). Interlinked fast and slow positive feedback loops have a short activation time and a long deactivation time, resulting in the small fluctuation of the on state. Our work of exploring the criterion to combine adaptation module and noise attenuation module follows the similar scenario: the topology determines the response time and therefore determines compatibility. In N-A networks, NF has shorter response time, which is beneficial for high sensitivity after combination, so NF is more compatible than PF as an upstream module. In A-N networks, IFFLP, the one with longer response time, maintains a higher percentage of sensitive output and thus has better compatibility than NFBLB as an upstream module. Thus, together with previous works, our finding highlights the significance of timescale and its dependence on the network topology in reverse engineering. In biological systems, ample examples of singling pathways adopt the topologies capable of the dual function of adaptation and noise attenuation. In two cases, Dictyostelium discoideum chemotaxis and p53 signaling network, we showed that these networks can effectively resist the noise while performing adaptation. Although many regulatory networks could be highlighted as in Figure 4 using sequentially connected modules, our explorations on many existing systems have suggested that in many adaptive systems a positive feedback loop or negative feedback loop is coupled with an adaptation module, creating an expanded dual-function module. In addition, the detail dynamics induced by such added positive/negative feedback is clearly related to noise attenuation in our analysis – an area not explored in previous studies that have focused only on adaptation. Interestingly, we found that in biological systems N-A networks appear more frequently than A-N networks. This is consistent with our finding that N-A architecture has higher compatibility for dual function. However, some adaptive systems such as chemotaxis network in Dictyostelium discoideum and EGFR signaling pathway in mammalian cells adopt the A-N architecture. One possible reason is that placing adaptation module in the upstream may be advantageous if the same upstream signal activates several downstream pathways of different characters. Since noise attenuation module is generally non-adaptive, placing noise attenuation module in the upstream may also cause persistent activation of downstream signaling pathways. Thus, it is conceivable that A-N networks could be more suitable in certain circumstances. In this work, the noise is assumed only from the input signal. Besides extrinsic noise due to the input fluctuation, the adaptation module also faces with intrinsic noise in the adaptation reaction. Such noise exhibits different characteristics, and may require different mechanisms to attenuate. Therefore, different design principles may emerge when considering mixed sources of noise. Although this work was limited to enzymatic regulatory networks, our approach can be naturally extended to other types of regulations or forms of networks. For instance, the topologies for three-node adaptive networks with transcriptional regulation can still be grouped into the same two categories: NFBLB and IFFLP. Furthermore, other types of modules can also be used for network assembly. For adaptation, besides negative feedback and incoherent feedforward, mechanisms such as state-dependent inactivation and antithetical integral feedback could generate perfect adaptation. For noise attenuation, linear cascades, time delay, and zero-order kinetics can also buffer noise. It would be interesting to systematically investigate the design principles for dual function made of other or mixed regulation types and functional modules, especially considering that the time scales of different regulations and modules can be very different. STAR Methods LEAD CONTACT AND MATERIALS AVAILABILITY Further information and requests for resources and reagents should be directed to and will be fulfilled by the Lead Contact, Lei Zhang. METHOD DETAILS Mathematical model Enzymatic regulatory networks We use enzymatic regulatory networks and Michaelis-Menten rate equations to model both three-node and four-node networks. An enzymatic regulatory network with IFFLP topology is illustrated in Figure 1D as an example. Each node is assumed to have active form and inactive form, with the total concentration as a constant. A positive regulation from node i to node j implies that the inactive form of the enzyme j can be converted to its active form by active enzyme i. Similarly, a negative regulation from node i to node j implies that the active form of enzyme j can be converted to its inactive form by active enzyme i. If the node i has only positive incoming regulations, a basal enzyme with constant concentration is assumed to deactivate the node. Thus, a three-node enzymatic regulatory network can be modeled by following equations: d A d t = f A = I k I A 1 − A 1 − A + K I A + ∑ i X i k X i A 1 − A 1 − A + K X i A − ∑ i Y i k Y i A A A + K Y i A, d B d t = f B = ∑ i X i k X i B 1 − B 1 − B + K X i B − ∑ i Y i k Y i B B B + K Y i B, d C d t = f C = ∑ i X i k X i C 1 − C 1 − C + K X i C − ∑ i Y i k Y i C C C + K Y i C, where I is the input intensity, and A, B and C are concentrations of the three enzymes in active form, respectively. Since the total concentration of each enzyme is set to be 1, 1 − A, 1 − B and 1 − C represents concentrations of the three enzymes in inactive form, respectively. X i in each equation represents the activating enzymes of the node while Y i the deactivating enzymes. Each term in above equations takes the form of Michaelis-Menten equation where capitalized K denotes Michaelis-Menten constant and lowercase k denotes the catalytic rate constant. For a four-node network there is an additional equation for node D: d D d t = f D = ∑ i X i k X i D 1 − D 1 − D + K X i D − ∑ i Y i k Y i D D C + K Y i D. Unless otherwise specified, all our simulations are based on enzymatic regulatory networks. Transcriptional regulatory networks The transcriptional regulatory network depicts interactions among genes’ products where each gene product can regulate the transcriptional activity of other genes as the transcription factor. In a transcriptional network topology, nodes and links represent gene products and transcriptional regulations respectively. In our model, transcriptional regulations are assumed to only affect the gene activation and have no effect on the degradation of gene products. If multiple TFs regulate the same gene, AND logic is applied. By modeling the regulated production rate with Hill function and the degradation rate with linear function, the three-node transcriptional regulatory network with AND logic can be modeled by following equations: d A d t = f A = v A I n I A I n I A + K I A n I A ∏ i X i n X i A X i n X i A + K X i A n X i A ∏ j K Y i A n Y i A Y i n Y i A + K Y i A n Y i A − A τ A, d B d t = f B = v B ∏ i X i n X i B X i n X i B + K X i B n X i B ∏ j K Y i B n Y i B Y i n Y i B + K Y i B n Y i B − B τ B, d C d t = f C = v C ∏ i X i n X i C X i n X i C + K X i C n X i C ∏ j K Y i C n Y i C Y i n Y i C + K Y i C n Y i C − C τ C, where I is the input intensity, and A, B and C are concentrations of the three gene products respectively. Each gene product has a degradation rate constant τ i − 1 and a maximal production rate ν i. X i in each equation represents the activator of the node while Y i the repressor. The Hill function representing positive regulation has two parameters K and n, which denote the activation coefficient and Hill coefficient, respectively. Likewise, the Hill function representing negative regulation also has parameters K and n, except that K is termed as the repression coefficient. When calculating Q values for 16,038 three-node transcriptional regulatory networks, above equations are normalized by setting v i = τ i − 1 for parameter reduction. Calculation of sensitivity, precision and NAR In our simulations, we set I 1 = 0.4 and I 2 = 0.45. When calculating Q values for enzymatic regulatory networks, the Latin hypercube method is used to sample the catalytic rate constants k ’s and Michaelis-Menten constants K ’s, which are from log-uniform distributions with the parameter ranges and, respectively. For transcriptional regulatory networks, the degradation rate constants τ i − 1 ‘s and the activation coefficients K ’s are sampled from log-uniform distributions with ranges and, respectively; the Hill coefficient n is sampled based on uniform distribution from 1 to 4. By performing ODE simulation, the deterministic dynamics for a given circuit is obtained and thus the sensitivity and the precision are calculated directly according to their definitions. We use linear noise approximation to calculate NAR. By assuming the noise is only from the input signal I and autocorrelation function of fluctuations exponentially decays with timescale τ 0 = 1/ ω, Ornstein-Uhlenbeck process is applied to approximate the dynamics of I : d I d t = − I − I s s τ 0 + 2 η 0 2 τ 0 ξ t where ξ t = is the white noise satisfying 〈 ξ t 〉 = 0 and 〈 ξ t ξ s 〉 = δ, and η 0 2 is the variance of I as t → ∞. We set I ss = I 1 and I 2 to calculate the NAR when system is at the steady state under I 1 and I 2 respectively. For saving calculation costs, we linearize the model to obtain an approximate NAR instead of a long-time simulation. According to LNA, we can solve the following equation to get NAR: M η + η M T + D = 0. In three-node networks, the matrix M, η, D are M =, η =, D =. Then NAR is just η C 2 / 〈 C 〉 2 η 0 2 / I S S 2 denotes the steady-state value of the node). In practice, we transformed M ij to M i j x j x i, η ij to η i j x i x j, D ij to D i j x i x j, where x 1 = I ss, x 2 = 〈 A 〉, x 3 = 〈 B 〉, x 4 = 〈 C 〉 so that we can get the square of NAR directly by dividing the last element in new η by the first element. These matrices are evaluated in steady state. As there are two different levels of input signal, we have two steady states and thus two values of NAR. When calculating Q values, the larger value of NAR is used. The method above can easily expand to four-node network. In fact, the NAR obtained by LNA can well approximate that obtained by a long-time simulation of stochastic differential equation. Analytical derivation of NAR and sensitivity IFFLP with general form of regulations To simplify the derivation, we assume that the dynamics of node A is the same as the input I. Then equations of IFFLP can be written as { τ B d B d t = f B τ C d C d t = f C. First we use LNA to derive NAR for the above system. We assume the fluctuation of A is an Ornstein-Uhlenbeck process with time scale τ 0 = 1/ ω and variance η 0 2. Then we can calculate M = = and D =, where k 1 = 〈 A 〉 〈 B 〉 ∂ f B ∂ A, k 2 = − ∂ f B ∂ B, k 4 = 〈 A 〉 〈 C 〉 ∂ f C ∂ A, k 5 = − 〈 B 〉 〈 C 〉 ∂ f C ∂ B, k 6 = − ∂ f C ∂ C. All k i are positive according to the sign of regulations in IFFLP. ⟨ A ⟩, ⟨ B ⟩, ⟨ C ⟩ denote steady states of A, B, C respectively. By solving the equation with respect to η M η + η M T + D = 0, we get the expression of NAR: NAR = η C 2 η A 2 = 2 + k 2 k 6 k 4 2 τ B 2 ω k 2 k 6 = 2 1 τ B + k 6 2 1 τ B + ω ) + k 2 k 6 k 4 2 2 ω k 2 k 6 ) + ω τ B ). From the expression of NAR, we can easily find that NAR is a decreasing function of τ C if τ B τ C ≥ k 2 k 6 ω 2 when the ratio of τ C to τ C is fixed as a constant. Then we approximate sensitivity by linearizing the system around steady state ⟨ A ⟩, ⟨ B ⟩, ⟨ C ⟩: = + Δ A k 4. The expressions of NAR and sensitivity can thus be obtained directly: NAR = k 4 2 τ B 2 ω = k 4 2 2 ω, and Sensitivity = | Δ C / 〈 C 〉 Δ A / 〈 A 〉 | = k 4 k 6 k 1 τ C k 6 τ B 1 − k 1 τ C k 6 τ B. When τ C τ B is fixed, we can see that sensitivity is a constant and NAR is a decreasing function of τ B if τ B τ C ≥ k 1 k 6 ω 2. NFBLB with general form of regulations To simplify the derivation, we assume that the dynamics of node A is the same as the input I. Then equations of NFBLB are { τ B d B d t = f B τ C d C d t = f C First we use LNA to derive NAR for the above system. We assume the fluctuation of A is an Ornstein-Uhlenbeck process with time scale τ 0 = 1/ ω and variance η 0 2. Then we can calculate M = = and D =, where k 1 = − ∂ f B ∂ B, k 2 = 〈 C 〉 〈 B 〉 ∂ f B ∂ C, k 3 = 〈 A 〉 〈 C 〉 ∂ f C ∂ A, k 4 = − 〈 B 〉 〈 C 〉 ∂ f C ∂ B, k 5 = − ∂ f C ∂ C. All k i are positive according to the sign of regulations in NFBLB. ⟨ A ⟩, ⟨ B ⟩, ⟨ C ⟩ denote steady states of A, B, C respectively. By solving the equation with respect to η. M η + η M T + D = 0, we get the expression of NAR: NAR = η C 2 η A 2 = k 3 2 = k 3 2. From the expression of NAR, we can easily find that NAR is a decreasing function of τ C if τ B τ C > k 1 k 5 + k 2 k 4 w 2 when the ratio of τ B to τ C is fixed as a constant. Then we approximate sensitivity by linearizing the system around steady state : = + Δ A where : Δ C = k 3 〈 C 〉 τ C 〈 A 〉 Δ A e λ 2 t − e λ 1 t λ 2 − λ 1 where λ 1 = − k 5 τ C + 2 − 4 k 4 k 2 τ B τ C 2, λ 2 = − k 5 τ C 2 − 4 k 4 k 2 τ B τ C 2. Let Δ C ′ = 0, and we obtain the peak time of Δ C : t p e a k = ln λ 1 − λ 2 = ln 2 − 4 k 4 k 2 τ B τ C − − k 5 τ C + 2 − 4 k 4 k 2 τ B τ C ) 2 − 4 k 4 k 2 τ B τ C. Then the highest value of Δ C is: Δ C = Δ A k 3 〈 C 〉 τ C 〈 A 〉 1 − λ 1 λ 2 λ 1 − λ 2. The sensitivity is derived naturally: Sensitivity = | Δ C / 〈 C 〉 Δ A / 〈 A 〉 | = k 3 τ C 1 − λ 1 λ 2 λ 1 − λ 2. The expression of sensitivity and t peak also holds for complex eigenvalues. However, the monotonicity with τ C τ B τ C is easy to analysis when eigenvalues are both negative real number. So only the situation with negative real eigenvalues is considered. Let x = 2 − 4 k 2 k 4 τ C τ B, λ 1 = − k 5 + x 2 τ C, λ 2 = − k 5 − x 2 τ C, then Sensitivity = Δ C 〈 C 〉 Δ A 〈 A 〉 = k 3 τ C 1 − λ 1 λ 2 λ 1 − λ 2 ∝ 1 k 5 − x k 5 + x − 2 x ∝ 1 1 − x / k 5 1 + x / k 5 − 2 x / k 5. Use x to denote x / k 5, and let f = 1 1 − x 1 + x − 2 x, x ∈. According to the monotonicity of f, sensitivity is an increasing function with x, and thus a decreasing function with τ C τ B. Fine-tuning timescales in three-node networks For a three-node network capable of perfect adaptation, we aim to maintain sensitivity and lower NAR by tuning τ B and τ C. Here, S denotes sensitivity and N denotes NAR. Maintaining sensitivity means ∂ S ∂ τ B Δ τ B + ∂ S ∂ τ C Δ τ C = 0 by neglecting the high-order terms. Similarly, lowering NAR means ∂ N ∂ τ B Δ τ B + ∂ N ∂ τ C Δ τ C < 0 by neglecting the high-order terms. Taking the first equality and the second inequality together, we have Δ τ C < 0. For instance, if > 0, we can reduce τ C, i.e., Δ τ C < 0, and set Δ τ B = − ∂ S ∂ τ C ∂ S ∂ τ B Δ τ C in order to lower NAR while maintaining sensitivity. It is similar to the case of < 0. Module combination in four-node networks We take PF-IFFLP as an example to show how to construct equations and parameters of the assembled four-node network. Before module combination, we assume that equations of PF are d A d t = I k I A u p 1 − A 1 − A + K I A u p + B k B A u p 1 − A 1 − A + K B A u p − F A k F A A u p A A + K F A A u p, d B d t = A k A B u p 1 − B 1 − B + K A B u p − F B k F B u p B B + K F B u p, and those of IFFLP d C d t = I k I C d w 1 − C 1 − C + K I C d w − D k D C d w C C + K D C d w, d D d t = I k I D d w 1 − D 1 − D + K I D d w − F D k F D d w D D + K F D d w. However, in PF-IFFLP, node C and node D receive the regulation from node B rather than the input I. So, to obtain equations of PF-IFFLP, we need replace variable I with variable B in equations of node C and node D while keeping other equations unchanged, i.e., d A d t = I k I A u p 1 − A 1 − A + K I A u p + B k B A u p 1 − A 1 − A + K B A u p − F A k F A A u p A A + K F A u p, d B d t = A k A B u p 1 − B 1 − B + K A B u p − F B k F B B u p B B + K F B B u p, d C d t = B k I C d w 1 − C 1 − C + K I C d w − D k D C d w C C + K D C d w, d D d t = B k I D d w 1 − D 1 − D + K I D d w − F D k F D D d w D D + K F D D d w. Equations and parameters for other assembled four-node networks can be obtained in a similar way. Evolution algorithm The evolution algorithm begins with an initial circuit collection including different networks with random parameters. Then the circuit collection evolves towards dual function with many rounds of growth and selection. In the growth phase, the circuit collection is doubled by adding a mutated copy of each circuit in the collection. The mutation of each circuit is carried out as following: randomly select one parameter based on the equal probability principle; modify the chosen parameter by multiplying a random number uniformly distributed between 0 and 2. In the selection phase, high-performance circuits are selected to form a new circuit collection with the original size. The performance of dual function is measured using a score function, which reaches maximum score when the circuit performs dual function. Here, the size of the initial circuit collection is set to be 1000, so each network in the subset will have about 27~28 different parameter sets in average. The score function we use is defined as the product of three factors, each of which ranges from 0 to 1. The first factor is defined by the minimum between the value of sensitivity and 1. The second factor is the minimum between precision/10 and 1. The third factor is the minimum between 0.2/NAR and 1. These three factors reflect how close the circuit’s sensitivity, precision and NAR approach to corresponding thresholds. The evolution process is terminated if the circuit with score=1 occurs or the maximum number of iterations is reached. DATA AND CODE AVAILABILITY STATMENT This paper presents no new data or code to make available. ​ Highlights An intrinsic trade-off exists in three-node networks Tuning timescales can partially mediate this trade-off with a cost Sequential assembly in four-node networks can effectively decouple two functions Biological adaptive networks are often associated with a noise attenuation module Supplementary Material 1 Click here to view. 